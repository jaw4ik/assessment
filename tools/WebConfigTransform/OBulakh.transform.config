<?xml version="1.0"?>
  <configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">

    <connectionStrings>
      <add name="DefaultConnection" connectionString="Data Source=EG-D-WEB07\SQL2014_Web;Initial Catalog=obulakh.easygenerator.com;Integrated Security=false;MultipleActiveResultSets=True;User ID=easygenerator;Password=Easy123!" providerName="System.Data.SqlClient" xdt:Transform="SetAttributes"
      xdt:Locator="Match(name)" />
      <add name="ElmahDBConnection" connectionString="Data Source=EG-D-WEB07\SQL2014_Web;Initial Catalog=obulakh.easygenerator.com-elmah;Integrated Security=false;MultipleActiveResultSets=True;User ID=easygenerator;Password=Easy123!" providerName="System.Data.SqlClient"
      xdt:Transform="Insert" />
    </connectionStrings>

    <fileStorage Path="../FileStorage" xdt:Transform="SetAttributes" />

	<templateStorage CustomTemplatesPath="../CustomTemplates" xdt:Transform="SetAttributes" />
	
    <authorization issuer="obulakh.easygenerator.com" xdt:Transform="SetAttributes">
      <endpoints>
        <endpoint name="storage" scopes="storage,auth" audience="storage-staging.easygenerator.com" secret="LacHZGA6Qk4CwHdVaS6ntt7C0Din9OufnvQii6ZG3NuB18yuU+cMkXkEr4CgsvnJ+COaTk9/H6120VUC87Zh6w==" apiKey="cZ5QY8epz28lCKsO0PAu2FP6SIV12E17" xdt:Transform="SetAttributes"
        xdt:Locator="Match(name)" />
        <endpoint name="auth" scopes="auth" audience="app" secret="LacHZGA6Qk4CwHdVaS6ntt7C0Din9OufnvQii6ZG3NuB18yuU+cMkXkEr4CgsvnJ+COaTk9/H6120VUC87Zh6w==" xdt:Locator="Match(name)" />
        <endpoint name="api" scopes="api" audience="app" secret="LacHZGA6Qk4CwHdVaS6ntt7C0Din9OufnvQii6ZG3NuB18yuU+cMkXkEr4CgsvnJ+COaTk9/H6120VUC87Zh6w==" xdt:Locator="Match(name)" />
        <endpoint name="preview" scopes="preview" audience="app" secret="LacHZGA6Qk4CwHdVaS6ntt7C0Din9OufnvQii6ZG3NuB18yuU+cMkXkEr4CgsvnJ+COaTk9/H6120VUC87Zh6w==" xdt:Locator="Match(name)" />
        <endpoint name="signalr" scopes="signalr" audience="app" secret="LacHZGA6Qk4CwHdVaS6ntt7C0Din9OufnvQii6ZG3NuB18yuU+cMkXkEr4CgsvnJ+COaTk9/H6120VUC87Zh6w==" xdt:Locator="Match(name)" />
        <endpoint name="upgradeAccount" scopes="upgradeAccount" audience="app" secret="LacHZGA6Qk4CwHdVaS6ntt7C0Din9OufnvQii6ZG3NuB18yuU+cMkXkEr4CgsvnJ+COaTk9/H6120VUC87Zh6w==" xdt:Locator="Match(name)" />
        <endpoint name="settings" scopes="settings,auth" audience="app" secret="LacHZGA6Qk4CwHdVaS6ntt7C0Din9OufnvQii6ZG3NuB18yuU+cMkXkEr4CgsvnJ+COaTk9/H6120VUC87Zh6w==" xdt:Locator="Match(name)" />
      </endpoints>
    </authorization>

    <mailSender interval="120" enable="true" xdt:Transform="SetAttributes">
      <mailTemplates>
        <mailTemplate name="SignedUpUserTemplate" to="v.kontsedaylo@ism.nl" xdt:Transform="SetAttributes" xdt:Locator="Match(name)"></mailTemplate>
        <mailTemplate name="FeedbackTemplate" to="v.kontsedaylo@ism.nl" xdt:Transform="SetAttributes" xdt:Locator="Match(name)"></mailTemplate>
        <mailTemplate name="NewsletterSubscriptionFailedTemplate" to="v.kontsedaylo@ism.nl" xdt:Transform="SetAttributes" xdt:Locator="Match(name)"></mailTemplate>
        <mailTemplate name="HttpRequestFailedTemplate" to="v.kontsedaylo@ism.nl" xdt:Transform="SetAttributes" xdt:Locator="Match(name)"></mailTemplate>
      </mailTemplates>
    </mailSender>
	
	<reCaptcha enabled="true" xdt:Transform="SetAttributes" />

    <publication serviceUrl="//elearning-branches.easygenerator.com" xdt:Transform="SetAttributes" />
	<wintoweb serviceUrl="http://wintoweb-staging.easygenerator.com/tickets" apiKey="ec0bd65a-222c-4b19-a32c-2a2cbd2eb3b8" xdt:Transform="SetAttributes" />

    <externalApi requiresHttps="false" xdt:Transform="SetAttributes">
    </externalApi>

    <appSettings>
      <add key="MixPanelToken" value="2437bde765c21c653b058ba64a5c2cfa" xdt:Transform="SetAttributes" xdt:Locator="Match(key)" />
      <add key="GoogleAnalyticsAccount" value="UA-35530889-1" xdt:Transform="SetAttributes" xdt:Locator="Match(key)" />
      <add key="StorageServiceUrl" value="storage-staging.easygenerator.com" xdt:Transform="SetAttributes" xdt:Locator="Match(key)" />
      <add key="magick.net.cachedirectory" value="." xdt:Transform="Insert" />
      <add key="ConvertionServiceUrl" value="convertion-staging.easygenerator.com/convertion" xdt:Transform="SetAttributes" xdt:Locator="Match(key)" />
      <add key="PlayerUrl" value="player-staging.easygenerator.com" xdt:Transform="SetAttributes" xdt:Locator="Match(key)" />
	  <add key="WinToWebConvertionServiceUrl" value="wintoweb-staging.easygenerator.com" xdt:Transform="SetAttributes" xdt:Locator="Match(key)" />
	  <add key="ImageLibraryOnlyHttps" value="true" xdt:Transform="SetAttributes" xdt:Locator="Match(key)" />
    <add key="ImageSeviceUrl" value="images-staging.easygenerator.com" xdt:Transform="SetAttributes" xdt:Locator="Match(key)"/>
    </appSettings>

    <system.web>
      <compilation debug="false" xdt:Transform="SetAttributes" />
    </system.web>
    <system.webServer>
    <rewrite  xdt:Transform="Insert">
        <rules>
          <rule name="Image redirection" stopProcessing="true"  xdt:Transform="SetAttributes">
            <match url="(storage\/image\/)([0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}(.jpg|.jpeg|.gif|.png|.bmp)$)" xdt:Transform="SetAttributes" />
            <action type="Redirect" url="https://images-staging.easygenerator.com/image/{R:2}" xdt:Transform="SetAttributes" />
          </rule>
        </rules>
      </rewrite>
    </system.webServer>

    <system.net>
      <mailSettings>
        <smtp>
          <network host="127.0.0.1" port="25" xdt:Transform="SetAttributes" />
        </smtp>
      </mailSettings>
    </system.net>

    <elmah>
      <errorLog type="easygenerator.Web.Components.Elmah.SqlErrorLogExtended, easygenerator.Web" connectionStringName="ElmahDBConnection" applicationName="easygenerator" xdt:Transform="Insert" />
    </elmah>

</configuration>
