!function(e){e.localize=function(e){return n[e]};var n={"changes are saved":"All changes are saved","changes are not saved":"Changes have NOT been saved. Please reload the page and change the settings again. Contact support@easygenerator.com if problem persists.","settings are not initialize":"Template settings are not initialized. Please reload the page and change the settings again. Contact support@easygenerator.com if problem persists.","results tracking":"Results Tracking","track and trace settings":"Track and trace settings","default":"easygenerator (recommended)",custom:"Custom LRS",disabled:"Disabled",enabled:"Enabled","advanced settings":"Advanced settings","report to":"Report to:","custom lrs settings":"Custom LRS settings","lrs url":"LRS URL","authentication required":"Authentication required","lap login":"LAP login","lap password":"LAP password","use statements":"Use statements:",started:"Started",stopped:"Stopped",passed:"Passed",answered:"Answered",mastered:"Mastered",expirenced:"Expirenced",failed:"Failed","mastery score settings":"Mastery score settings","mastery score hint":"Mastery score (for each learning objective):","template language":"Template language",xx:"Custom",cn:"Chinese",de:"German",en:"English",fr:"French",it:"Italian",nl:"Dutch",tr:"Turkish",ua:"Ukrainian","pt-br":"Portuguese (Brazil)","choose language for your course":"Choose language for your course",defaultText:"Default",translation:"Translation"}}(window.app=window.app||{}),function(){ko.bindingHandlers.number={init:function(e){var n=$(e),t=100;n.on("keydown",function(e){var n=e.charCode||e.keyCode||0;return 8==n||9==n||46==n||n>=37&&40>=n||n>=48&&57>=n||n>=96&&105>=n}),n.on("keyup",function(){$(this).val()>t&&$(this).val(t)})}},ko.bindingHandlers.disableDragNDrop={init:function(e){$(e).on("dragstart",function(e){e.preventDefault()})}},ko.bindingHandlers.spinner={init:function(e,n){var t=n();$(e).spinner("changed",function(e,n){t(n)})}},ko.bindingHandlers.switchToggle={init:function(e,n){var t=ko.bindingHandlers.switchToggle,a=t.viewModel(e,n),o=ko.unwrap(n().value());a.setInitialValue(o),t.onClick(e,function(){a.toggle();var e=ko.unwrap(n().value());n().value(!e)})},update:function(e,n){var t=ko.bindingHandlers.switchToggle.viewModel(e,n),a=ko.unwrap(n().value());t.updateValue(a)},viewModel:function(e){function n(e){s(e),i(e)}function t(){var e=a();s(!e),l.stop().animate({marginLeft:r(!e)},250)}function a(){return d.hasClass("on")}function o(e){a()!=e&&n(e)}function s(e){d.toggleClass("on",e),d.toggleClass("off",!e)}function i(e){l.css("margin-left",r(e)+"px")}function r(e){return e?0:d.height()-d.width()}var d=$(e),l=$(".switch-toggle-wrapper",d);return{setInitialValue:n,updateValue:o,toggle:t}},onClick:function(e,n){var t=$(e),a=!1;t.mousedown(function(e){1==e.which&&(a=!0,n())}),t.click(function(){return a?void(a=!1):void n()})}},ko.bindingHandlers.dropdown={cssClasses:{dropdown:"dropdown",disabled:"disabled",expanded:"expanded",optionsList:"dropdown-options-list",optionItem:"dropdown-options-item",currentItem:"dropdown-current-item",currentItemText:"dropdown-current-item-text",indicatorHolder:"dropdown-indicator-holder",indicator:"dropdown-indicator"},init:function(e,n){var t=$(e),a=ko.bindingHandlers.dropdown.cssClasses;t.addClass(a.dropdown);var o=$("<div />").addClass(a.currentItem).appendTo(t);$("<div />").addClass(a.currentItemText).appendTo(o);var s=$("<div />").addClass(a.indicatorHolder).appendTo(o);$("<span />").addClass(a.indicator).appendTo(s),$("<ul />").addClass(a.optionsList).appendTo(t),o.on("click",function(e){t.hasClass(a.disabled)||(o.toggleClass(a.expanded),e.stopPropagation())});var i=function(){o.removeClass(a.expanded)};$("html").bind("click",i),$(window).bind("blur",i),ko.utils.domNodeDisposal.addDisposeCallback(e,function(){$("html").unbind("click",i),$(window).unbind("blur",i)})},update:function(e,n){var t=$(e),a=ko.bindingHandlers.dropdown.cssClasses,o=t.find("ul."+a.optionsList),s=t.find("div."+a.currentItemText),i=n().options,r=n().optionsText,d=n().value,l=n().optionsValue,u=ko.unwrap(d),c=ko.unwrap(n().disable);c?t.toggleClass(a.disabled):t.removeClass(a.disabled),o.empty(),$.each(i,function(e,n){return n[l]==u?void s.text(n[r]):void $("<li />").addClass(a.optionItem).appendTo(o).text(n[r]).on("click",function(e){d(n[l]),t.trigger("change")})})}},ko.bindingHandlers.tabs={init:function(e){var n=$(e),t="data-tab-link",a="data-tab",o="active",s=n.find("["+t+"]"),i=n.find("["+a+"]");i.hide(),s.first().addClass(o),i.first().show(),s.each(function(e,r){var d=$(r);d.on("click",function(){var e=d.attr(t),r=n.find("["+a+'="'+e+'"]');s.removeClass(o),d.addClass(o),i.hide(),r.show()})})}},ko.bindingHandlers.localize={init:function(e,n){var t=$(e),a=ko.unwrap(n());t.html(app.localize(a))}}}(),function(e){function n(n){function t(e){e&&(l.enableXAPI(e.enabled),e.selectedLrs&&l.selectLrsByName(e.selectedLrs),e.lrs&&l.setCustomLrsSettings(e.lrs),e.allowedVerbs&&l.setStatements(e.allowedVerbs))}function a(){l.advancedSettingsExpanded(!l.advancedSettingsExpanded())}function o(e){ko.utils.arrayForEach(l.lrsOptions,function(e){e.isSelected(!1)}),e.isSelected(!0)}function s(e){ko.utils.arrayForEach(l.lrsOptions,function(n){n.isSelected(n.name===e)})}function i(e){ko.utils.objectForEach(l.statements,function(n,t){t(e.indexOf(n)>-1)})}function r(e){l.lrsUrl(e.uri||""),l.authenticationRequired(e.authenticationRequired||!1),l.lapLogin(e.credentials.username||""),l.lapPassword(e.credentials.password||"")}function d(){var e=[];return ko.utils.objectForEach(l.statements,function(n,t){t()&&e.push(n)}),{enabled:l.enableXAPI(),selectedLrs:l.selectedLrs(),lrs:{uri:l.lrsUrl(),authenticationRequired:l.authenticationRequired(),credentials:{username:l.lapLogin(),password:l.lapPassword()}},allowedVerbs:e}}var l=this;return l.advancedSettingsExpanded=ko.observable(!1),l.enableXAPI=ko.observable(!0),l.lrsOptions=[new e.LrsOption("default",!0),new e.LrsOption("custom")],l.selectedLrs=ko.computed(function(){var e="";return ko.utils.arrayForEach(l.lrsOptions,function(n){n.isSelected()&&(e=n.name)}),e},l),l.customLrsEnabled=ko.computed(function(){return l.enableXAPI()&&l.selectedLrs()!=l.lrsOptions[0].name}),l.lrsUrl=ko.observable(""),l.authenticationRequired=ko.observable(!1),l.lapLogin=ko.observable(),l.lapPassword=ko.observable(),l.credentialsEnabled=ko.computed(function(){return l.customLrsEnabled()&&l.authenticationRequired()}),l.statements={started:ko.observable(!0),stopped:ko.observable(!0),experienced:ko.observable(!0),mastered:ko.observable(!0),answered:ko.observable(!0),passed:ko.observable(!0),failed:ko.observable(!0)},l.toggleAdvancedSettings=a,l.selectLrs=o,l.selectLrsByName=s,l.setStatements=i,l.setCustomLrsSettings=r,l.getData=d,t(n),l}function t(e,n){var t=this;return t.name=e,t.isSelected=ko.observable(n===!0),t}function a(n,t){function a(n,t){ko.utils.arrayForEach(n||[],function(n){i(new e.LanguageModel(n.code,e.localize(n.code),n.url))});var a=r(c),o=new e.LanguageModel(u,e.localize(u),a?a.resourcesUrl:null,t?t.customTranslations:null);i(o);var s=t&&t.selected?t.selected:c;l.selectedLanguageCode(s)}function o(){return l.selectedLanguageCode()===u}function s(){var e=r(u);return e?e.getNotMappedTranslations():[]}function i(e){l.languages.push(e)}function r(e){return ko.utils.arrayFirst(l.languages,function(n){return n.code===e})}function d(){var e={};l.selectedLanguageCode()&&(e.selected=l.selectedLanguageCode());var n=s();return n&&!$.isEmptyObject(n)&&(e.customTranslations=n),e}var l=this,u="xx",c="en";l.languages=[];var g=ko.observable(t&&t.selected?t.selected:null);return l.selectedLanguageCode=ko.pureComputed({read:function(){return g()},write:function(e){var n=r(e);if(n){if(n.isLoaded)return void g(e);l.isLanguageLoading(!0),n.load().done(function(){g(e),l.isLanguageLoading(!1)})}}}),l.selectedLanguageTranslations=ko.pureComputed(function(){var e=r(l.selectedLanguageCode());return e?e.getTranslations():null}),l.isLanguageLoading=ko.observable(!1),l.isLanguageEditable=o,l.getCustomTranslations=s,l.getData=d,a(n,t),l}function o(e,n,t,a){function o(e){g=l(e)}function s(){return g}function i(){return u(g)}function r(){return d(c.resourcesUrl).then(function(e){if(p){var n={};$.each(e,function(e,t){n[e]="string"==typeof p[e]?p[e]:t}),c.setTranslations(n)}else c.setTranslations(e);c.isLoaded=!0})}function d(e){return $.ajax({url:e,dataType:"json",contentType:"application/json"})}function l(e){var n=[];return e&&Object.keys(e).forEach(function(t){n.push({key:t,value:e[t]})}),n}function u(e){var n={};return e&&e.forEach(function(e){n[e.key]=e.value}),n}var c=this,g=[],p=a;c.code=e,c.name=n,c.isLoaded=!1,c.load=r,c.resourcesUrl=t,c.setTranslations=o,c.getTranslations=s,c.getNotMappedTranslations=i,a&&c.setTranslations(a)}function s(e){function n(){return{score:t.score}}var t=this;return t.score=e.score,t.getData=n,t}e.TrackingDataModel=n,e.LrsOption=t,e.LanguagesModel=a,e.LanguageModel=o,e.MasteryScore=s}(window.app=window.app||{}),function(e){var n=null,t=null,a={trackingData:null,masteryScore:null,languages:null};a.getCurrentSettingsData=function(e){return $.extend({},e||n,{xApi:a.trackingData.getData(),masteryScore:a.masteryScore.getData(),languages:a.languages.getData()})},a.getCurrentExtraData=function(){return{}},a.saveChanges=function(){var o=a.getCurrentSettingsData(),s=a.getCurrentExtraData(),i=JSON.stringify(o),r=JSON.stringify(s);(JSON.stringify(n)!==i||JSON.stringify(t)!==r)&&window.egApi.saveSettings(i,r,e.localize("changes are saved"),e.localize("changes are not saved")).done(function(){n=o,t=s})},a.init=function(){var o=window.egApi;return o.init().then(function(){var s=o.getManifest(),i=o.getSettings();a.trackingData=new e.TrackingDataModel(i.xApi),a.masteryScore=new e.MasteryScore(i.masteryScore),a.languages=new e.LanguagesModel(s.languages,i.languages),n=a.getCurrentSettingsData(i),t=a.getCurrentExtraData()}).fail(function(){o.sendNotificationToEditor(e.localize("settings are not initialize"),!1)})},a.init().done(function(){$(document).ready(function(){ko.applyBindings(a,$(".settings-container")[0]),$(window).on("blur",a.saveChanges)})})}(window.app=window.app||{});