!function(e){e.localize=function(e){return n[e]};var n={"changes are saved":"All changes are saved","changes are not saved":"Changes have NOT been saved. Please reload the page and change the settings again. Contact support@easygenerator.com if problem persists.","settings are not initialize":"Template settings are not initialized. Please reload the page and change the settings again. Contact support@easygenerator.com if problem persists.","general settings":"General Settings","pdf export":"PDF export (experimental):","show download as pdf button":'Show button "Download course in PDF format"',"results tracking":"Results Tracking","default":"easygenerator (recommended)",custom:"Custom LRS","track and trace settings":"Track and trace settings","results tracking option":"Results tracking:","results tracking hint":"(will not affect tracking and tracing in SCORM/LMS)","allow user to skip option":"Allow user to skip tracking and tracing:","allow scoring of content pages":"Allow scoring of content pages:","show confirmation popup":"Show confirmation dialogue:","show confirmation popup hint":"(when submitting final results)",disabled:"Disabled",enabled:"Enabled",allow:"Allow",forbid:"Forbid",hide:"Hide",show:"Show","advanced settings":"Advanced settings","report to":"Report to:","custom lrs settings":"Custom LRS settings","lrs url":"LRS URL","authentication required":"Authentication required","lap login":"LAP login","lap password":"LAP password","use statements":"Use statements:",started:"Started",stopped:"Stopped",passed:"Passed",answered:"Answered",mastered:"Mastered",expirenced:"Expirenced",failed:"Failed",progressed:"Progressed","save progress cross device":"Save progress cross device (requires login and password):","allow social media":"Allow login via social media","mastery score settings":"Mastery score settings","mastery score caption":"Mastery score:","mastery score hint":"(for each learning objective):","template language":"Template language",xx:"Custom",cn:"Chinese",de:"German",en:"English",fr:"French",it:"Italian",nl:"Dutch",tr:"Turkish",ua:"Ukrainian",es:"Spanish","pt-br":"Portuguese (Brazil)",ru:"Russian",ms:"Malay",kr:"Korean","nb-no":"Norwegian (Bokmal)","nn-no":"Norwegian (Nynorsk)",vi:"Vietnamese","choose language for your course":"Choose language for your course",defaultText:"Default",translation:"Translation"}}(window.app=window.app||{}),function(){ko.bindingHandlers.number={init:function(e){var n=$(e),a=100;n.on("keydown",function(e){var n=e.charCode||e.keyCode||0;return 8==n||9==n||46==n||n>=37&&n<=40||n>=48&&n<=57||n>=96&&n<=105}),n.on("keyup",function(){$(this).val()>a&&$(this).val(a)})}},ko.bindingHandlers.disableDragNDrop={init:function(e){$(e).on("dragstart",function(e){e.preventDefault()})}},ko.bindingHandlers.spinner={init:function(e,n){var a=n();$(e).spinner("changing",function(e,n){a(n)})}},ko.bindingHandlers.switchToggle={init:function(e,n){var a=ko.bindingHandlers.switchToggle,o=a.viewModel(e,n),t=ko.unwrap(n().value());o.setInitialValue(t),a.onClick(e,function(){o.toggle();var e=ko.unwrap(n().value());n().value(!e)})},update:function(e,n){var a=ko.bindingHandlers.switchToggle.viewModel(e,n),o=ko.unwrap(n().value());a.updateValue(o)},viewModel:function(e){function n(e){i(e),s(e)}function a(){var e=o();i(!e),d.stop().animate({marginLeft:r(!e)},250)}function o(){return l.hasClass("on")}function t(e){o()!=e&&n(e)}function i(e){l.toggleClass("on",e),l.toggleClass("off",!e)}function s(e){d.css("margin-left",r(e)+"px")}function r(e){return e?0:l.height()-l.width()}var l=$(e),d=$(".switch-toggle-wrapper",l);return{setInitialValue:n,updateValue:t,toggle:a}},onClick:function(e,n){var a=$(e),o=!1;a.mousedown(function(e){1==e.which&&(o=!0,n())}),a.click(function(){return o?void(o=!1):void n()})}},ko.bindingHandlers.dropdown={cssClasses:{dropdown:"dropdown",disabled:"disabled",expanded:"expanded",optionsList:"dropdown-options-list",optionItem:"dropdown-options-item",currentItem:"dropdown-current-item",currentItemText:"dropdown-current-item-text",indicatorHolder:"dropdown-indicator-holder",indicator:"dropdown-indicator"},init:function(e,n){var a=$(e),o=ko.bindingHandlers.dropdown.cssClasses;a.addClass(o.dropdown);var t=$("<div />").addClass(o.currentItem).appendTo(a);$("<div />").addClass(o.currentItemText).appendTo(t);var i=$("<div />").addClass(o.indicatorHolder).appendTo(t);$("<span />").addClass(o.indicator).appendTo(i),$("<ul />").addClass(o.optionsList).appendTo(a),t.on("click",function(e){a.hasClass(o.disabled)||(t.toggleClass(o.expanded),e.stopPropagation())});var s=function(){t.removeClass(o.expanded)};$("html").bind("click",s),$(window).bind("blur",s),ko.utils.domNodeDisposal.addDisposeCallback(e,function(){$("html").unbind("click",s),$(window).unbind("blur",s)})},update:function(e,n){var a=$(e),o=ko.bindingHandlers.dropdown.cssClasses,t=a.find("ul."+o.optionsList),i=a.find("div."+o.currentItemText),s=n().options,r=n().optionsText,l=n().value,d=n().optionsValue,c=ko.unwrap(l),u=ko.unwrap(n().disable);u?a.toggleClass(o.disabled):a.removeClass(o.disabled),t.empty(),$.each(s,function(e,n){return n[d]==c?void i.text(n[r]):void $("<li />").addClass(o.optionItem).appendTo(t).text(n[r]).on("click",function(e){l(n[d]),a.trigger("change")})})}},ko.bindingHandlers.tabs={init:function(e){var n=$(e),a="data-tab-link",o="data-tab",t="active",i=n.find("["+a+"]"),s=n.find("["+o+"]");s.hide(),i.first().addClass(t),s.first().show(),i.each(function(e,r){var l=$(r);l.on("click",function(){var e=l.attr(a),r=n.find("["+o+'="'+e+'"]');i.removeClass(t),l.addClass(t),s.hide(),r.show()})})}},ko.bindingHandlers.localize={init:function(e,n){var a=$(e),o=ko.unwrap(n());a.html(app.localize(o))}}}(),function(e){function n(e){function n(e){e&&o.enabled(e.enabled)}function a(){return{enabled:o.enabled()}}var o=this;o.enabled=ko.observable(!1),o.getData=a,n(e)}function a(e){function n(e){e&&(d.enableXAPI(e.enabled),d.allowToSkipTracking(!e.required),e.selectedLrs&&d.selectLrsByName(e.selectedLrs),e.lrs&&d.setCustomLrsSettings(e.lrs),e.allowedVerbs&&d.setStatements(e.allowedVerbs))}function a(){d.advancedSettingsExpanded(!d.advancedSettingsExpanded())}function o(e){ko.utils.arrayForEach(d.lrsOptions,function(e){e.isSelected(!1)}),e.isSelected(!0)}function t(e){ko.utils.arrayForEach(d.lrsOptions,function(n){n.isSelected(n.name===e)})}function i(e){ko.utils.objectForEach(d.statements,function(n,a){a(e.indexOf(n)>-1)})}function s(e){d.lrsUrl(e.uri||""),d.authenticationRequired(e.authenticationRequired||!1),d.lapLogin(e.credentials.username||""),d.lapPassword(e.credentials.password||"")}function r(){var e=[];return ko.utils.objectForEach(d.statements,function(n,a){a()&&e.push(n)}),{enabled:d.enableXAPI(),required:!d.allowToSkipTracking(),selectedLrs:d.selectedLrs(),lrs:{uri:d.lrsUrl(),authenticationRequired:d.authenticationRequired(),credentials:{username:d.lapLogin(),password:d.lapPassword()}},allowedVerbs:e}}function l(e,n){var a=this;return a.name=e,a.isSelected=ko.observable(n===!0),a}var d=this;return d.advancedSettingsExpanded=ko.observable(!1),d.enableXAPI=ko.observable(!0),d.allowToSkipTracking=ko.observable(!0),d.lrsOptions=[new l("default",(!0)),new l("custom")],d.selectedLrs=ko.computed(function(){var e="";return ko.utils.arrayForEach(d.lrsOptions,function(n){n.isSelected()&&(e=n.name)}),e},d),d.customLrsEnabled=ko.computed(function(){return d.enableXAPI()&&d.selectedLrs()!=d.lrsOptions[0].name}),d.lrsUrl=ko.observable(""),d.authenticationRequired=ko.observable(!1),d.lapLogin=ko.observable(),d.lapPassword=ko.observable(),d.credentialsEnabled=ko.computed(function(){return d.customLrsEnabled()&&d.authenticationRequired()}),d.statements={started:ko.observable(!0),stopped:ko.observable(!0),experienced:ko.observable(!0),mastered:ko.observable(!0),answered:ko.observable(!0),passed:ko.observable(!0),failed:ko.observable(!0),progressed:ko.observable(!0)},d.toggleAdvancedSettings=a,d.selectLrs=o,d.selectLrsByName=t,d.setStatements=i,d.setCustomLrsSettings=s,d.getData=r,n(e),d}function o(n,a){function o(e,n){var a=e.name.toLowerCase(),o=n.name.toLowerCase();return a<o?-1:a>o?1:0}function t(n,a){ko.utils.arrayForEach(n||[],function(n){r(new c(n.code,e.localize(n.code),n.url))}),u.languages.sort(o);var t=l(p),i=new c(g,e.localize(g),t?t.resourcesUrl:null,a?a.customTranslations:null);r(i);var s=a&&a.selected?a.selected:p;u.selectedLanguageCode(s)}function i(){return u.selectedLanguageCode()===g}function s(){var e=l(g);return e?e.getNotMappedTranslations():[]}function r(e){u.languages.push(e)}function l(e){return ko.utils.arrayFirst(u.languages,function(n){return n.code===e})}function d(){var e={};u.selectedLanguageCode()&&(e.selected=u.selectedLanguageCode());var n=s();return n&&!$.isEmptyObject(n)&&(e.customTranslations=n),e}function c(e,n,a,o){function t(e){g=d(e)}function i(){return g}function s(){return c(g)}function r(){return l(u.resourcesUrl).then(function(e){if(p){var n={};$.each(e,function(e,a){n[e]="string"==typeof p[e]?p[e]:a}),u.setTranslations(n)}else u.setTranslations(e);u.isLoaded=!0})}function l(e){return $.ajax({url:e,dataType:"json",contentType:"application/json"})}function d(e){var n=[];return e&&Object.keys(e).forEach(function(a){n.push({key:a,value:e[a]})}),n}function c(e){var n={};return e&&e.forEach(function(e){n[e.key]=e.value}),n}var u=this,g=[],p=o;u.code=e,u.name=n,u.isLoaded=!1,u.load=r,u.resourcesUrl=a,u.setTranslations=t,u.getTranslations=i,u.getNotMappedTranslations=s,o&&u.setTranslations(o)}var u=this,g="xx",p="en";u.languages=[];var f=ko.observable(a&&a.selected?a.selected:null);return u.selectedLanguageCode=ko.pureComputed({read:function(){return f()},write:function(e){var n=l(e);if(n){if(n.isLoaded)return void f(e);u.isLanguageLoading(!0),n.load().done(function(){f(e),u.isLanguageLoading(!1)})}}}),u.selectedLanguageTranslations=ko.pureComputed(function(){var e=l(u.selectedLanguageCode());return e?e.getTranslations():null}),u.isLanguageLoading=ko.observable(!1),u.isLanguageEditable=i,u.getCustomTranslations=s,u.getData=d,t(n,a),u}function t(e){function n(){return{score:a.score()}}var a=this;return a.score=ko.observable(e&&e.score?e.score:100),a.getData=n,a}e.TrackingDataModel=a,e.LanguagesModel=o,e.MasteryScore=t,e.PdfExport=n}(window.app=window.app||{}),function(e){var n=null,a=null,o={isError:ko.observable(!1),trackingData:null,masteryScore:null,languages:null,pdfExport:null,showConfirmationPopup:ko.observable(!0),allowContentPagesScoring:ko.observable(!1),allowCrossDeviceSaving:ko.observable(!0),allowSocialLogin:ko.observable(!0)};o.getCurrentSettingsData=function(e){return $.extend({},e||n,{pdfExport:o.pdfExport.getData(),xApi:o.trackingData.getData(),masteryScore:o.masteryScore.getData(),languages:o.languages.getData(),showConfirmationPopup:o.showConfirmationPopup(),allowContentPagesScoring:o.allowContentPagesScoring(),allowCrossDeviceSaving:o.allowCrossDeviceSaving(),allowLoginViaSocialMedia:o.allowSocialLogin()})},o.getCurrentExtraData=function(){return{}},o.saveChanges=function(){var t=o.getCurrentSettingsData(),i=o.getCurrentExtraData(),s=JSON.stringify(t),r=JSON.stringify(i);JSON.stringify(n)===s&&JSON.stringify(a)===r||window.egApi.saveSettings(s,r,e.localize("changes are saved"),e.localize("changes are not saved")).done(function(){n=t,a=i})},o.init=function(){var t=window.egApi;return t.init().then(function(){var i=t.getManifest(),s=t.getSettings(),r=i&&i.defaultTemplateSettings?i.defaultTemplateSettings:{};o.pdfExport=new e.PdfExport(s.pdfExport||r.pdfExport),o.masteryScore=new e.MasteryScore(s.masteryScore||r.masteryScore),o.trackingData=new e.TrackingDataModel(s.xApi||r.xApi),o.languages=new e.LanguagesModel(i.languages,s.languages),s.hasOwnProperty("showConfirmationPopup")?o.showConfirmationPopup(s.showConfirmationPopup):r.hasOwnProperty("showConfirmationPopup")&&o.showConfirmationPopup(r.showConfirmationPopup),s.hasOwnProperty("allowContentPagesScoring")?o.allowContentPagesScoring(s.allowContentPagesScoring):r.hasOwnProperty("allowContentPagesScoring")&&o.allowContentPagesScoring(r.allowContentPagesScoring),s.hasOwnProperty("allowCrossDeviceSaving")?o.allowCrossDeviceSaving(s.allowCrossDeviceSaving):r.hasOwnProperty("allowCrossDeviceSaving")&&o.allowCrossDeviceSaving(r.allowCrossDeviceSaving),s.hasOwnProperty("allowLoginViaSocialMedia")?o.allowSocialLogin(s.allowLoginViaSocialMedia):r.hasOwnProperty("allowLoginViaSocialMedia")&&o.allowSocialLogin(r.allowLoginViaSocialMedia),n=o.getCurrentSettingsData(s),a=o.getCurrentExtraData()}).fail(function(){o.isError(!0)})},o.init().always(function(){$(document).ready(function(){ko.applyBindings(o,$(".settings-container")[0]),$(window).on("blur",o.saveChanges)})})}(window.app=window.app||{});