$(function(){function r(n){return decodeURI((RegExp(n+"=(.+?)(&|$)").exec(location.search)||[,null])[1])}var f=r("courseId"),e=r("templateId"),i=location.protocol+"//"+location.host,u=i+"/api/course/"+f+"/template/"+e,o=location.toString().indexOf("/settings/settings.html"),s=location.toString().substring(0,o),h=1,n={trackingData:function(){var n={};return n.enableXAPI=ko.observable(!1),n.lrsOptions=[{key:"default",text:"easygenerator (recommended)"},{key:"custom",text:"custom LRS"}],n.selectedLrs=ko.observable(n.lrsOptions[0].key),n.customLrsEnabled=ko.computed(function(){return n.enableXAPI()&&n.selectedLrs()!=n.lrsOptions[0].key}),n.lrsUrl=ko.observable(""),n.authenticationRequired=ko.observable(!1),n.lapLogin=ko.observable(),n.lapPassword=ko.observable(),n.credentialsEnabled=ko.computed(function(){return n.customLrsEnabled()&&n.authenticationRequired()}),n.statements={started:ko.observable(!0),stopped:ko.observable(!0),experienced:ko.observable(!0),mastered:ko.observable(!0),answered:ko.observable(!0),passed:ko.observable(!0),failed:ko.observable(!0)},n}(),isSaved:ko.observable(!1),isFailed:ko.observable(!1),logo:function(){var n={};return n.url=ko.observable("").extend({throttle:300}),n.hasLogo=ko.computed(function(){return n.url()!==""}),n.clear=function(){n.url("")},n.isError=ko.observable(!1),n.errorText=ko.observable(""),n.errorDescription=ko.observable(""),n.isLoading=ko.observable(!1),n}(),themes:function(){var n={};return n.list=[{title:"Cartoon light",key:"cartoon"},{title:"Grey scheme",key:"grey"},{title:"Black scheme",key:"black"},{title:"Flat scheme",key:"flat"}],n.default="cartoon",n.selected=ko.observable(""),ko.utils.arrayMap(n.list,function(t){return t.isSelected=ko.observable(!1),t.select=function(){ko.utils.arrayForEach(n.list,function(n){n.isSelected(!1)});t.isSelected(!0);n.selected(t.key)},t}),n.setSelected=function(t){var i=ko.utils.arrayFirst(n.list,function(n){return n.key==t});!i||i.select()},n.setSelected(n.default),n.openDemo=function(){window.open(s+"?theme="+n.selected(),"_blank")},n}(),defaultTranslations:{en:[{key:"[course]",value:"Course:"},{key:"[start course]",value:"Start course"},{key:"[finish course]",value:"Finish course"},{key:"[learning objectives]",value:"Learning objectives:"},{key:"[start]",value:"Start"},{key:"[home]",value:"Home"},{key:"[learning content]",value:"Learning content"},{key:"[submit]",value:"Submit"},{key:"[try again]",value:"Try again"},{key:"[next]",value:"Next"},{key:"[correct answer]",value:"Correct answer"},{key:"[incorrect answer]",value:"Incorrect answer"},{key:"[previous question]",value:"previous"},{key:"[next question]",value:"next"},{key:"[of]",value:"of"},{key:"[to complete]",value:"to complete"},{key:"[text matching question hint]",value:"Drag items from right column to the left to match the pairs"},{key:"[text matching question drop here]",value:"Drop here"},{key:"[statement question true text]",value:"True"},{key:"[statement question false text]",value:"False"},{key:"[drag and drop question all texts are placed]",value:"All texts are placed"},{key:"[drag and drop question drop here]",value:"Drop here"},{key:"[fill in the blank choose answer]",value:"Choose the answer..."},{key:"[thank you message]",value:"Thank you, you can close the page now"},{key:"[there are no questions]",value:"No questions"},{key:"[browser not supported]",value:"Your browser is currently not supported."},{key:"[browser not supported hint]",value:"Don’t worry, there is an easy fix. All you have to do is click one of the icons below and follow the instructions."},{key:"[page not found title]",value:"Page not found (404)"},{key:"[page not found message]",value:"Sorry, the page you have been looking for has not been found. Try checking the URL on errors, use the navigation above or click 'Home' link below."},{key:"[tracking and tracing header]",value:"Your credentials for progress tracking"},{key:"[tracking and tracing hint]",value:'Please enter your credentials and click "Start and report my results "to enable result tracking. Otherwise, click "Do not report, just start".'},{key:"[tracking and tracing name field]",value:"Your name"},{key:"[tracking and tracing email field]",value:"Your e-mail"},{key:"[tracking and tracing name is not valid]",value:"Fill in your name"},{key:"[tracking and tracing email is not valid]",value:"Enter a valid e-mail"},{key:"[tracking and tracing skip reporting]",value:"Do not report, just start"},{key:"[tracking and tracing start]",value:"Start and report my results"},{key:"[tracking and tracing error]",value:"Something is wrong"},{key:"[tracking and tracing error hint]",value:"If you continue without restarting, your learning results will not be reported."},{key:"[tracking and tracing restart course]",value:"Restart course"},{key:"[tracking and tracing continue anyway]",value:"Continue anyway"},{key:"[tracking and tracing reporting progress]",value:"reporting results..."}],nl:[{key:"[course]",value:"Cursus:"},{key:"[start course]",value:"Start cursus"},{key:"[finish course]",value:"Stop cursus"},{key:"[learning objectives]",value:"Leerdoelen:"},{key:"[start]",value:"Start"},{key:"[home]",value:"Home"},{key:"[learning content]",value:"Leerstof"},{key:"[submit]",value:"Invoeren"},{key:"[try again]",value:"Probeer opnieuw"},{key:"[next]",value:"Volgende"},{key:"[correct answer]",value:"Juist antwoord"},{key:"[incorrect answer]",value:"Onluist antwoord"},{key:"[previous question]",value:"Vorige"},{key:"[next question]",value:"Volgende"},{key:"[of]",value:"van"},{key:"[to complete]",value:"compleet"},{key:"[text matching question hint]",value:"Sleep items van de rechterkolom naar links om kloppende paren te maken"},{key:"[text matching question drop here]",value:"Plaats hier"},{key:"[statement question true text]",value:"Waar"},{key:"[statement question false text]",value:"Niet waar"},{key:"[drag and drop question all texts are placed]",value:"Alle teksten zijn geplaatst"},{key:"[drag and drop question drop here]",value:"Plaats hier"},{key:"[fill in the blank choose answer]",value:"Kies het antwoord…"},{key:"[thank you message]",value:"Bedankt, je kan nu de pagina sluiten"},{key:"[there are no questions]",value:"Geen vragen"},{key:"[browser not supported]",value:"Uw browser wordt niet ondersteund."},{key:"[browser not supported hint]",value:"Maak je geen zorgen er is een simpeleoplossing. Klik op een van de iconen beneden en volg de instructies"},{key:"[page not found title]",value:"Pagina niet gevonden (404)"},{key:"[page not found message]",value:"Sorry, de pagina is niet gevonden. Controleer de link of klik op home."},{key:"[tracking and tracing header]",value:"Je gegevens om de resultaten op te slaan"},{key:"[tracking and tracing hint]",value:"Vul je gegevens in en druk op 'Start en leg mijn resultaten vast'. Of klik op 'leg mijn resultaten niet vast'"},{key:"[tracking and tracing name field]",value:"Naam"},{key:"[tracking and tracing email field]",value:"Email"},{key:"[tracking and tracing name is not valid]",value:"Vul je naam in"},{key:"[tracking and tracing email is not valid]",value:"Voer een geldig email adres in"},{key:"[tracking and tracing skip reporting]",value:"Leg mijn resultaten niet vast"},{key:"[tracking and tracing start]",value:"Start en leg mijn resultaten vast"},{key:"[tracking and tracing error]",value:"Er is iets misgegaan"},{key:"[tracking and tracing error hint]",value:"Als je doorgaat worden je leerresultaten niet vastgelegd"},{key:"[tracking and tracing restart course]",value:"Herstart cursus"},{key:"[tracking and tracing continue anyway]",value:"Ga door"},{key:"[tracking and tracing reporting progress]",value:"Resultaten vastleggen..."}],ua:[{key:"[course]",value:"Курс :"},{key:"[start course]",value:"Почати курс"},{key:"[finish course]",value:"Закінчити курс"},{key:"[learning objectives]",value:"Мета навчання:"},{key:"[start]",value:"Почати"},{key:"[home]",value:"Головна"},{key:"[learning content]",value:"Навчальный матеріал"},{key:"[submit]",value:"Відповісти"},{key:"[try again]",value:"Спробувати ще"},{key:"[next]",value:"Далі"},{key:"[correct answer]",value:"Вірна відповідь"},{key:"[incorrect answer]",value:"Відповідь не вірна"},{key:"[previous question]",value:"Назад"},{key:"[next question]",value:"Вперед"},{key:"[of]",value:"з"},{key:"[to complete]",value:"для досягнення цілі"},{key:"[text matching question hint]",value:"Перетягніть відповіді з правої колонки до лівої таким чином, щоб вони відповідали визначенням з першої колонки"},{key:"[text matching question drop here]",value:"Сюди"},{key:"[statement question true text]",value:"Вірно"},{key:"[statement question false text]",value:"Невірно"},{key:"[drag and drop question all texts are placed]",value:"Усі тексти вже використані"},{key:"[drag and drop question drop here]",value:"Сюди"},{key:"[fill in the blank choose answer]",value:"Оберіть варіант..."},{key:"[thank you message]",value:"Дякуємо. Тепер сторінку можна закрити"},{key:"[there are no questions]",value:"Питання відсутні"},{key:"[browser not supported]",value:"Ваш браузер не підтримується"},{key:"[browser not supported hint]",value:"Не хвилюйтеся, це легко виправити. Все, що вам потрібно - це натиснути на одну з іконок, розташованих нижче і дотримуватись інструкцій"},{key:"[page not found title]",value:"Сторінка не знайдена (404)"},{key:"[page not found message]",value:"Вибачте, але сторінку, яку ви шукали, не знайдено. Спробуйте перевірити URL на помилки, використати навігацію вище або посилання на головну сторінку нижче."},{key:"[tracking and tracing header]",value:"Ваші дані для відправки результатів"},{key:"[tracking and tracing hint]",value:'Будь-ласка, вкажіть необхідні дані та натисніть "Почати курс та відстежувати мій прогрес" для того, щоб відправляти результати. Якщо Ви не бажаєте відстежувати прогрес, натисніть "Почати курс без відправки результатів"'},{key:"[tracking and tracing name field]",value:"Ваше ім'я"},{key:"[tracking and tracing email field]",value:"Ваша електронна адреса"},{key:"[tracking and tracing name is not valid]",value:"Вкажіть Ваше ім'я"},{key:"[tracking and tracing email is not valid]",value:"Вкажіть дійсну електронну адресу"},{key:"[tracking and tracing skip reporting]",value:"Пропустити цей крок"},{key:"[tracking and tracing start]",value:"Так, відстежувати мій прогрес"},{key:"[tracking and tracing error]",value:"Помилка"},{key:"[tracking and tracing error hint]",value:"Натисніть 'Спробувати ще'. Якщо помилка повторюється і ви бажаєте продовжити курс без відправки результатів - натисніть 'Продовжити'."},{key:"[tracking and tracing restart course]",value:"Спробувати ще"},{key:"[tracking and tracing continue anyway]",value:"Продовжити"},{key:"[tracking and tracing reporting progress]",value:"Надсилаемо прогресс..."}],xx:[{key:"[course]",value:ko.observable("Course:")},{key:"[start course]",value:ko.observable("Start course")},{key:"[finish course]",value:ko.observable("Finish course")},{key:"[learning objectives]",value:ko.observable("Learning objectives:")},{key:"[start]",value:ko.observable("Start")},{key:"[home]",value:ko.observable("Home")},{key:"[learning content]",value:ko.observable("Learning content")},{key:"[submit]",value:ko.observable("Submit")},{key:"[try again]",value:ko.observable("Try again")},{key:"[next]",value:ko.observable("Next")},{key:"[correct answer]",value:ko.observable("Correct answer")},{key:"[incorrect answer]",value:ko.observable("Incorrect answer")},{key:"[previous question]",value:ko.observable("previous")},{key:"[next question]",value:ko.observable("next")},{key:"[of]",value:ko.observable("of")},{key:"[to complete]",value:ko.observable("to complete")},{key:"[text matching question hint]",value:ko.observable("Drag items from right column to the left to match the pairs")},{key:"[text matching question drop here]",value:ko.observable("Drop here")},{key:"[statement question true text]",value:ko.observable("True")},{key:"[statement question false text]",value:ko.observable("False")},{key:"[drag and drop question all texts are placed]",value:ko.observable("All texts are placed")},{key:"[drag and drop question drop here]",value:ko.observable("Drop here")},{key:"[fill in the blank choose answer]",value:ko.observable("Choose the answer...")},{key:"[thank you message]",value:ko.observable("Thank you. It is now safe to close this page.")},{key:"[there are no questions]",value:ko.observable("No questions")},{key:"[browser not supported]",value:ko.observable("Your browser is currently not supported.")},{key:"[browser not supported hint]",value:ko.observable("Don’t worry, there is an easy fix. All you have to do is click one of the icons below and follow the instructions.")},{key:"[page not found title]",value:ko.observable("Page not found (404)")},{key:"[page not found message]",value:ko.observable("Sorry, the page you have been looking for has not been found. Try checking the URL on errors, use the navigation above or click 'Home' link below.")},{key:"[tracking and tracing header]",value:ko.observable("Your credentials for progress tracking")},{key:"[tracking and tracing hint]",value:ko.observable('Please enter your credentials and click "Start and report my progress" to enable progress tracking. Otherwise, click "Do not report, just start".')},{key:"[tracking and tracing name field]",value:ko.observable("Your name")},{key:"[tracking and tracing email field]",value:ko.observable("Your e-mail")},{key:"[tracking and tracing name is not valid]",value:ko.observable("Fill in your name")},{key:"[tracking and tracing email is not valid]",value:ko.observable("Enter a valid e-mail")},{key:"[tracking and tracing skip reporting]",value:ko.observable("Do not report, just start")},{key:"[tracking and tracing start]",value:ko.observable("Start and report my progress")},{key:"[tracking and tracing error]",value:ko.observable("Something is wrong")},{key:"[tracking and tracing error hint]",value:ko.observable("If you continue without restarting, your learning progress will not be reported.")},{key:"[tracking and tracing restart course]",value:ko.observable("Restart course")},{key:"[tracking and tracing continue anyway]",value:ko.observable("Continue anyway")},{key:"[tracking and tracing reporting progress]",value:ko.observable("reporting progress...")}]},languages:[{key:"en",name:"English"},{key:"nl",name:"Dutch"},{key:"ua",name:"Ukrainian"},{key:"xx",name:"Custom"}],hasStarterPlan:ko.observable(!0),masteryScore:ko.observable("")},t;n.escapeHtml=function(n){return $("<div/>").text(n).html()};n.unescapeHtml=function(n){return $("<div/>").html(n).text()};n.selectedLanguage=ko.observable(n.languages[0].key);n.isCustom=ko.computed(function(){var t=n.selectedLanguage();return t=="xx"});n.translations=ko.computed(function(){return n.defaultTranslations[n.selectedLanguage()]});n.getCustomTranslations=function(){return n.defaultTranslations.xx};n.saveChanges=function(){var i={logo:{url:n.logo.url()},xApi:{enabled:n.trackingData.enableXAPI(),selectedLrs:n.trackingData.selectedLrs(),lrs:{uri:n.trackingData.lrsUrl(),authenticationRequired:n.trackingData.authenticationRequired(),credentials:{username:n.trackingData.lapLogin(),password:n.trackingData.lapPassword()}},allowedVerbs:$.map(n.trackingData.statements,function(n,t){return n()?t:undefined})},masteryScore:{score:n.masteryScore()},theme:{key:n.themes.selected()},translations:$.map(n.defaultTranslations[n.selectedLanguage()],function(t){return{key:t.key,value:n.escapeHtml(n.isCustom()?t.value():t.value)}})},t;n.isFailed(!1);n.isSaved(!1);t={selectedLanguage:n.selectedLanguage(),customTranslations:$.map(n.getCustomTranslations(),function(t){return{key:t.key,value:n.escapeHtml(t.value())}})};$.post(u,{settings:JSON.stringify(i),extraData:JSON.stringify(t)}).done(function(){n.isSaved(!0)}).fail(function(){n.isFailed(!0)})};ko.bindingHandlers.fadeVisible={init:function(n,t){var i=t();$(n).toggle(ko.unwrap(i))},update:function(n,t){var i=t();ko.unwrap(i)?$(n).fadeIn():$(n).fadeOut()}};ko.bindingHandlers.number={init:function(n){var t=$(n),i=100;t.on("keydown",function(n){var t=n.charCode||n.keyCode||0;return t==8||t==9||t==46||t>=37&&t<=40||t>=48&&t<=57||t>=96&&t<=105});t.on("keyup",function(){$(this).val()>i&&$(this).val(i)})}};ko.bindingHandlers.disableDragNDrop={init:function(n){$(n).on("dragstart",function(n){n.preventDefault()})}};ko.bindingHandlers.spinner={init:function(n,t){var i=t();$(n).spinner("changed",function(n,t){i(t)})}};ko.bindingHandlers.switchToggle={init:function(n,t){var i=ko.bindingHandlers.switchToggle,r=i.viewModel(n,t),u=ko.unwrap(t().value());r.setInitialValue(u);i.onClick(n,function(){r.toggle();var n=ko.unwrap(t().value());t().value(!n)})},update:function(n,t){var i=ko.bindingHandlers.switchToggle.viewModel(n,t),r=ko.unwrap(t().value());i.updateValue(r)},viewModel:function(n){function r(n){f(n);h(n)}function o(){var n=u();f(!n);i.stop().animate({marginLeft:e(!n)},250)}function u(){return t.hasClass("on")}function s(n){u()!=n&&r(n)}function f(n){t.toggleClass("on",n);t.toggleClass("off",!n)}function h(n){i.css("margin-left",e(n)+"px")}function e(n){return n?0:t.height()-t.width()}var t=$(n),i=$(".switch-toggle-wrapper",t);return{setInitialValue:r,updateValue:s,toggle:o}},onClick:function(n,t){var r=$(n),i=!1;r.mousedown(function(n){n.which==1&&(i=!0,t())});r.click(function(){if(i){i=!1;return}t()})}};ko.bindingHandlers.dropdown={cssClasses:{dropdown:"dropdown",disabled:"disabled",expanded:"expanded",optionsList:"dropdown-options-list",optionItem:"dropdown-options-item",currentItem:"dropdown-current-item",currentItemText:"dropdown-current-item-text",indicatorHolder:"dropdown-indicator-holder",indicator:"dropdown-indicator"},init:function(n){var u=$(n),t=ko.bindingHandlers.dropdown.cssClasses,i,f,r;u.addClass(t.dropdown);i=$("<div />").addClass(t.currentItem).appendTo(u);$("<div />").addClass(t.currentItemText).appendTo(i);f=$("<div />").addClass(t.indicatorHolder).appendTo(i);$("<span />").addClass(t.indicator).appendTo(f);$("<ul />").addClass(t.optionsList).appendTo(u);i.on("click",function(n){u.hasClass(t.disabled)||(i.toggleClass(t.expanded),n.stopPropagation())});r=function(){i.removeClass(t.expanded)};$("html").bind("click",r);$(window).bind("blur",r);ko.utils.domNodeDisposal.addDisposeCallback(n,function(){$("html").unbind("click",r);$(window).unbind("blur",r)})},update:function(n,t){var i=$(n),r=ko.bindingHandlers.dropdown.cssClasses,u=i.find("ul."+r.optionsList),s=i.find("div."+r.currentItemText),h=t().options,f=t().optionsText,e=t().value,o=t().optionsValue,c=ko.unwrap(e),l=ko.unwrap(t().disable);l?i.toggleClass(r.disabled):i.removeClass(r.disabled);u.empty();$.each(h,function(n,t){if(t[o]==c){s.text(t[f]);return}$("<li />").addClass(r.optionItem).appendTo(u).text(t[f]).on("click",function(){e(t[o]);i.trigger("change")})})}};ko.applyBindings(n,$("#settingsForm")[0]);t={apiUrl:i+"/storage/image/upload",maxFileSize:10,supportedExtensions:["jpeg","jpg","png","bmp","gif"],somethingWentWrongMessage:{title:"Something went wrong",description:"Please, try again"},status:{"default":function(){n.logo.isLoading(!1);n.logo.isError(!1)},fail:function(t){n.logo.clear();n.logo.isLoading(!1);n.logo.errorText(t.title);n.logo.errorDescription(t.description);n.logo.isError(!0)},loading:function(){n.logo.isLoading(!0)}},button:{enable:function(){this.$input.attr("disabled",!1).closest(".image-upload-button").removeClass("disabled")},disable:function(){this.$input.attr("disabled",!0).closest(".image-upload-button").addClass("disabled")},submit:function(){this.$input[0].form.submit();this.disable();t.status.loading()},$input:$("#logoInput")},init:function(){t.button.$input.on("change",t.processFile);t.button.enable()},processFile:function(){if(!this.files){t.button.submit();return}if(this.files.length!==0){var n=this.files[0],i=n.name.split(".").pop().toLowerCase();if($.inArray(i,t.supportedExtensions)===-1){t.status.fail({title:"Unsupported image format",description:"(Allowed formats: "+t.supportedExtensions.join(", ")+")"});return}if(n.size>t.maxFileSize*1048576){t.status.fail({title:"File is too large",description:"(Max file size: "+t.maxFileSize+"MB)"});return}t.uploadFile(n)}},uploadFile:function(n){t.button.disable();t.status.loading();var i=new FormData;i.append("file",n);$.ajax({url:t.apiUrl,type:"POST",data:i,cache:!1,dataType:"json",processData:!1,contentType:!1}).done(function(n){t.handleResponse(n)}).fail(function(){t.status.fail(t.somethingWentWrongMessage);t.button.enable()})},handleResponse:function(i){try{if(!i)throw"Response is empty";if(typeof i!="object"&&(i=JSON.parse(i)),!i||!i.success||!i.data)throw"Request is not success";n.logo.url(i.data.url);t.status.default()}catch(r){t.status.fail(t.somethingWentWrongMessage)}finally{t.button.enable()}}};$.ajax({cache:!1,url:u,dataType:"json",success:function(t){var f={logo:{},xApi:{lrs:{credentials:{}}},masteryScore:{}},e={customTranslations:[]},i,r,u;try{i=JSON.parse(t.settings)||f}catch(o){i=f}try{r=JSON.parse(t.extraData)||e}catch(o){r=e}if(n.trackingData.enableXAPI(i.xApi.enabled||!1),n.trackingData.selectedLrs(i.xApi.selectedLrs||"default"),n.trackingData.lrsUrl(i.xApi.lrs.uri||""),n.trackingData.authenticationRequired(i.xApi.lrs.authenticationRequired||!1),n.trackingData.lapLogin(i.xApi.lrs.credentials.username||""),n.trackingData.lapPassword(i.xApi.lrs.credentials.password||""),i.xApi.allowedVerbs&&$.each(n.trackingData.statements,function(n,t){t($.inArray(n,i.xApi.allowedVerbs)>-1)}),n.logo.url(i.logo.url||""),typeof i.masteryScore!="undefined"&&i.masteryScore.score>=0&&i.masteryScore.score<=100?n.masteryScore(i.masteryScore.score):n.masteryScore(100),i.theme&&i.theme.key&&n.themes.setSelected(i.theme.key),u=n.getCustomTranslations(),r.customTranslations.length==0&&i.translations!=null){$.each(i.translations,function(t){$.each(u,function(r){i.translations[t].key===u[r].key&&u[r].value(n.unescapeHtml(i.translations[t].value))})});n.selectedLanguage("xx");return}$.each(r.customTranslations,function(t){$.each(u,function(i){r.customTranslations[t].key===u[i].key&&u[i].value(n.unescapeHtml(r.customTranslations[t].value))})});r.selectedLanguage!=null&&r.selectedLanguage!=undefined&&n.selectedLanguage(r.selectedLanguage)},error:function(){n.masteryScore(100)}});$.ajax({url:i+"/api/identify",type:"POST",contentType:"application/json",dataType:"json",success:function(i){if(i.hasOwnProperty("subscription")&&i.subscription.hasOwnProperty("accessType")){var r=i.subscription.accessType>=h&&new Date(i.subscription.expirationDate)>=new Date;n.hasStarterPlan(r);r&&t.init()}else n.hasStarterPlan(!1)},error:function(){n.hasStarterPlan(!1)}})});