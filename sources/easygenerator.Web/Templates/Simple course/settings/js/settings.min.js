!function(e){e.localize=function(e){return n[e]};var n={cartoon:"Cartoon light",grey:"Grey scheme",black:"Black scheme",flat:"Flat scheme","default":"easygenerator (recommended)",custom:"Custom LRS",xx:"Custom",cn:"Chinese",de:"German",en:"English",fr:"French",it:"Italian",nl:"Dutch",tr:"Turkish",ua:"Ukrainian","pt-br":"Portuguese (Brazil)","changes are saved":"All changes are saved","changes are not saved":"Changes have NOT been saved. Please reload the page and change the settings again. Contact support@easygenerator.com if problem persists.","settings are not initialize":"Template settings are not initialized. Please reload the page and change the settings again. Contact support@easygenerator.com if problem persists.","graphical customization":"Graphical customization","results tracking":"Results Tracking","template language":"Template language","customize your course":"Customize your course","look and feel of the course":"Change the look and feel of the course","custom course logo":"Custom course logo:",or:"or","upload logo image":"Upload logo image","logo hint":"Your logo will appear here<p>(recommended size 300 x 50 px)</p>","clear logo":"Clear logo","choose color scheme":"Choose color scheme:","upgrade account hint":'You have to <a target="_blank" href="/account/upgrade">upgrade your account</a> in order to set custom course logo',"track and trace settings":"Track and trace settings",disabled:"Disabled",enabled:"Enabled","advanced settings":"Advanced settings","report to":"Report to:","custom lrs settings":"Custom LRS settings","lrs url":"LRS URL","authentication required":"Authentication required","lap login":"LAP login","lap password":"LAP password","use statements":"Use statements:",started:"Started",stopped:"Stopped",passed:"Passed",answered:"Answered",mastered:"Mastered",expirenced:"Expirenced",failed:"Failed","mastery score settings":"Mastery score settings","mastery score hint":"Mastery score (for each learning objective):","choose language for your course":"Choose language for your course",defaultText:"Default",translation:"Translation","background change":"Change background:","background update":"Change background","background remove":"Clear background","background default":"Default","background repeat":"Repeat","background fullscreen":"Fullscreen","background upgrade account hint":'You have to <a target="_blank" href="/account/upgrade">upgrade your account</a> in order to set custom course background'}}(window.app=window.app||{}),function(e){function n(e){var n=e.name.split(".").pop().toLowerCase();return-1===$.inArray(n,o.supportedExtensions)?{title:"Unsupported image format",description:"(Allowed formats: "+o.supportedExtensions.join(", ")+")"}:e.size>1024*o.maxFileSize*1024?{title:"File is too large",description:"(Max file size: "+o.maxFileSize+"MB)"}:!0}var t=location.protocol+"//"+location.host+"/storage/image/upload",a={title:"Something went wrong",description:"Please, try again"},o={maxFileSize:10,supportedExtensions:["jpeg","jpg","png","bmp","gif"]};e.upload=function(e){var r=$.Deferred(),i=$("<form>").hide().attr("method","post").attr("enctype","multipart/form-data").insertAfter("body"),s=$("<input>").attr("accept",o.supportedExtensions.map(function(e){return"."+e}).join(", ")).attr("type","file").attr("name","file").on("change",function(){e&&e();var o=this.files[0],i=n(o);if(i!==!0)return void r.reject(i);var s=new FormData;s.append("file",o),$.ajax({url:t,type:"POST",data:s,contentType:!1,processData:!1}).done(function(e){try{var n=JSON.parse(e);n&&n.success&&n.data&&n.data.url?r.resolve(n.data.url):r.reject(a)}catch(t){r.reject(a)}}).fail(function(){r.reject(a)})}).appendTo(i);return s.click(),r.promise()}}(window.app=window.app||{}),function(){ko.bindingHandlers.fadeVisible={init:function(e,n){var t=n();$(e).toggle(ko.unwrap(t))},update:function(e,n){var t=n();ko.unwrap(t)?$(e).fadeIn():$(e).fadeOut()}},ko.bindingHandlers.number={init:function(e){var n=$(e),t=100;n.on("keydown",function(e){var n=e.charCode||e.keyCode||0;return 8==n||9==n||46==n||n>=37&&40>=n||n>=48&&57>=n||n>=96&&105>=n}),n.on("keyup",function(){$(this).val()>t&&$(this).val(t)})}},ko.bindingHandlers.disableDragNDrop={init:function(e){$(e).on("dragstart",function(e){e.preventDefault()})}},ko.bindingHandlers.spinner={init:function(e,n){var t=n();$(e).spinner("changed",function(e,n){t(n)})}},ko.bindingHandlers.switchToggle={init:function(e,n){var t=ko.bindingHandlers.switchToggle,a=t.viewModel(e,n),o=ko.unwrap(n().value());a.setInitialValue(o),t.onClick(e,function(){a.toggle();var e=ko.unwrap(n().value());n().value(!e)})},update:function(e,n){var t=ko.bindingHandlers.switchToggle.viewModel(e,n),a=ko.unwrap(n().value());t.updateValue(a)},viewModel:function(e){function n(e){r(e),i(e)}function t(){var e=a();r(!e),c.stop().animate({marginLeft:s(!e)},250)}function a(){return l.hasClass("on")}function o(e){a()!=e&&n(e)}function r(e){l.toggleClass("on",e),l.toggleClass("off",!e)}function i(e){c.css("margin-left",s(e)+"px")}function s(e){return e?0:l.height()-l.width()}var l=$(e),c=$(".switch-toggle-wrapper",l);return{setInitialValue:n,updateValue:o,toggle:t}},onClick:function(e,n){var t=$(e),a=!1;t.mousedown(function(e){1==e.which&&(a=!0,n())}),t.click(function(){return a?void(a=!1):void n()})}},ko.bindingHandlers.dropdown={cssClasses:{dropdown:"dropdown",disabled:"disabled",expanded:"expanded",optionsList:"dropdown-options-list",optionItem:"dropdown-options-item",currentItem:"dropdown-current-item",currentItemText:"dropdown-current-item-text",indicatorHolder:"dropdown-indicator-holder",indicator:"dropdown-indicator"},init:function(e,n){var t=$(e),a=ko.bindingHandlers.dropdown.cssClasses;t.addClass(a.dropdown);var o=$("<div />").addClass(a.currentItem).appendTo(t);$("<div />").addClass(a.currentItemText).appendTo(o);var r=$("<div />").addClass(a.indicatorHolder).appendTo(o);$("<span />").addClass(a.indicator).appendTo(r),$("<ul />").addClass(a.optionsList).appendTo(t),o.on("click",function(e){t.hasClass(a.disabled)||(o.toggleClass(a.expanded),e.stopPropagation())});var i=function(){o.removeClass(a.expanded)};$("html").bind("click",i),$(window).bind("blur",i),ko.utils.domNodeDisposal.addDisposeCallback(e,function(){$("html").unbind("click",i),$(window).unbind("blur",i)})},update:function(e,n){var t=$(e),a=ko.bindingHandlers.dropdown.cssClasses,o=t.find("ul."+a.optionsList),r=t.find("div."+a.currentItemText),i=n().options,s=n().optionsText,l=n().value,c=n().optionsValue,u=ko.unwrap(l),d=ko.unwrap(n().disable);d?t.toggleClass(a.disabled):t.removeClass(a.disabled),o.empty(),$.each(i,function(e,n){return n[c]==u?void r.text(n[s]):void $("<li />").addClass(a.optionItem).appendTo(o).text(n[s]).on("click",function(e){l(n[c]),t.trigger("change")})})}},ko.bindingHandlers.tabs={init:function(e){var n=$(e),t="data-tab-link",a="data-tab",o="active",r=n.find("["+t+"]"),i=n.find("["+a+"]");i.hide(),r.first().addClass(o),i.first().show(),r.each(function(e,s){var l=$(s);l.on("click",function(){var e=l.attr(t),s=n.find("["+a+'="'+e+'"]');r.removeClass(o),l.addClass(o),i.hide(),s.show()})})}},ko.bindingHandlers.localize={init:function(e,n){var t=$(e),a=ko.unwrap(n());t.html(app.localize(a))}},ko.bindingHandlers.background={init:function(e){$(e).css("background-size","cover").css("background-position","center").css("background-repeat","no-repeat")},update:function(e,n){var t=ko.unwrap(n());if($(e).css("background-image","none"),t){var a=new Image;a.onload=function(){$(e).css("background-image","url("+t+")")},a.src=t}}}}(),function(e){function n(n){function t(e){e&&c.setUrl(e.url)}function a(){c.isLoading()||e.upload(function(){i()}).done(function(e){s(e),o()}).fail(function(e){r(e.title,e.description)})}function o(){c.isLoading(!1),c.isError(!1)}function r(e,n){c.clear(),c.isLoading(!1),c.errorText(e),c.errorDescription(n),c.isError(!0)}function i(){c.isLoading(!0)}function s(e){c.url(e||"")}function l(){return{url:c.url()}}var c=this;return c.url=ko.observable(""),c.hasLogo=ko.computed(function(){return""!==c.url()}),c.clear=function(){c.url("")},c.isError=ko.observable(!1),c.errorText=ko.observable(""),c.errorDescription=ko.observable(""),c.isLoading=ko.observable(!1),c.setUrl=s,c.getData=l,c.upload=a,t(n),c}function t(n){function t(e){e&&s.selectByName(e.key)}function a(e){ko.utils.arrayForEach(s.list,function(e){e.isSelected(!1)}),e.isSelected(!0)}function o(e){ko.utils.arrayForEach(s.list,function(n){n.isSelected(n.name===e)})}function r(){var e=location.toString().indexOf("/settings/settings"),n=location.toString().substring(0,e),t=["v="+(new Date).getTime(),"theme="+s.selectedThemeName()].join("&");window.open(n+"?"+t,"_blank")}function i(){return{key:s.selectedThemeName()}}var s=this;return s.list=[new e.ThemeModel("cartoon",!0),new e.ThemeModel("grey"),new e.ThemeModel("black"),new e.ThemeModel("flat")],s.selectedThemeName=ko.computed(function(){var e="";return ko.utils.arrayForEach(s.list,function(n){n.isSelected()&&(e=n.name)}),e},s),s.select=a,s.selectByName=o,s.openDemo=r,s.getData=i,t(n),s}function a(e,n){var t=this;return t.name=e,t.isSelected=ko.observable(n===!0),t}function o(n){function t(e){e&&(c.enableXAPI(e.enabled),e.selectedLrs&&c.selectLrsByName(e.selectedLrs),e.lrs&&c.setCustomLrsSettings(e.lrs),e.allowedVerbs&&c.setStatements(e.allowedVerbs))}function a(){c.advancedSettingsExpanded(!c.advancedSettingsExpanded())}function o(e){ko.utils.arrayForEach(c.lrsOptions,function(e){e.isSelected(!1)}),e.isSelected(!0)}function r(e){ko.utils.arrayForEach(c.lrsOptions,function(n){n.isSelected(n.name===e)})}function i(e){ko.utils.objectForEach(c.statements,function(n,t){t(e.indexOf(n)>-1)})}function s(e){c.lrsUrl(e.uri||""),c.authenticationRequired(e.authenticationRequired||!1),c.lapLogin(e.credentials.username||""),c.lapPassword(e.credentials.password||"")}function l(){var e=[];return ko.utils.objectForEach(c.statements,function(n,t){t()&&e.push(n)}),{enabled:c.enableXAPI(),selectedLrs:c.selectedLrs(),lrs:{uri:c.lrsUrl(),authenticationRequired:c.authenticationRequired(),credentials:{username:c.lapLogin(),password:c.lapPassword()}},allowedVerbs:e}}var c=this;return c.advancedSettingsExpanded=ko.observable(!1),c.enableXAPI=ko.observable(!0),c.lrsOptions=[new e.LrsOption("default",!0),new e.LrsOption("custom")],c.selectedLrs=ko.computed(function(){var e="";return ko.utils.arrayForEach(c.lrsOptions,function(n){n.isSelected()&&(e=n.name)}),e},c),c.customLrsEnabled=ko.computed(function(){return c.enableXAPI()&&c.selectedLrs()!=c.lrsOptions[0].name}),c.lrsUrl=ko.observable(""),c.authenticationRequired=ko.observable(!1),c.lapLogin=ko.observable(),c.lapPassword=ko.observable(),c.credentialsEnabled=ko.computed(function(){return c.customLrsEnabled()&&c.authenticationRequired()}),c.statements={started:ko.observable(!0),stopped:ko.observable(!0),experienced:ko.observable(!0),mastered:ko.observable(!0),answered:ko.observable(!0),passed:ko.observable(!0),failed:ko.observable(!0)},c.toggleAdvancedSettings=a,c.selectLrs=o,c.selectLrsByName=r,c.setStatements=i,c.setCustomLrsSettings=s,c.getData=l,t(n),c}function r(e,n){var t=this;return t.name=e,t.isSelected=ko.observable(n===!0),t}function i(n,t){function a(n,t){ko.utils.arrayForEach(n||[],function(n){i(new e.LanguageModel(n.code,e.localize(n.code),n.url))});var a=s(d),o=new e.LanguageModel(u,e.localize(u),a?a.resourcesUrl:null,t?t.customTranslations:null);i(o);var r=t&&t.selected?t.selected:d;c.selectedLanguageCode(r)}function o(){return c.selectedLanguageCode()===u}function r(){var e=s(u);return e?e.getNotMappedTranslations():[]}function i(e){c.languages.push(e)}function s(e){return ko.utils.arrayFirst(c.languages,function(n){return n.code===e})}function l(){var e={};c.selectedLanguageCode()&&(e.selected=c.selectedLanguageCode());var n=r();return n&&!$.isEmptyObject(n)&&(e.customTranslations=n),e}var c=this,u="xx",d="en";c.languages=[];var g=ko.observable(t&&t.selected?t.selected:null);return c.selectedLanguageCode=ko.pureComputed({read:function(){return g()},write:function(e){var n=s(e);if(n){if(n.isLoaded)return void g(e);c.isLanguageLoading(!0),n.load().done(function(){g(e),c.isLanguageLoading(!1)})}}}),c.selectedLanguageTranslations=ko.pureComputed(function(){var e=s(c.selectedLanguageCode());return e?e.getTranslations():null}),c.isLanguageLoading=ko.observable(!1),c.isLanguageEditable=o,c.getCustomTranslations=r,c.getData=l,a(n,t),c}function s(e,n,t,a){function o(e){g=c(e)}function r(){return g}function i(){return u(g)}function s(){return l(d.resourcesUrl).then(function(e){if(p){var n={};$.each(e,function(e,t){n[e]="string"==typeof p[e]?p[e]:t}),d.setTranslations(n)}else d.setTranslations(e);d.isLoaded=!0})}function l(e){return $.ajax({url:e,dataType:"json",contentType:"application/json"})}function c(e){var n=[];return e&&Object.keys(e).forEach(function(t){n.push({key:t,value:e[t]})}),n}function u(e){var n={};return e&&e.forEach(function(e){n[e.key]=e.value}),n}var d=this,g=[],p=a;d.code=e,d.name=n,d.isLoaded=!1,d.load=s,d.resourcesUrl=t,d.setTranslations=o,d.getTranslations=r,d.getNotMappedTranslations=i,a&&d.setTranslations(a)}function l(n){n=n||{image:{src:null,type:"default"}};var t=this;t.image=ko.observable(n.image.src),t.image.isUploading=ko.observable(!1),t.image.isEmpty=ko.computed(function(){return!(t.image()&&t.image().length>0)}),t.type=ko.observable(n.image.type),t.type["default"]=function(){t.type("default")},t.type.repeat=function(){t.type("repeat")},t.type.fullscreen=function(){t.type("fullscreen")},t.errorTitle=ko.observable(),t.errorDescription=ko.observable(),t.hasError=ko.observable(!1),t.changeImage=function(){t.image.isUploading()||e.upload(function(){t.image.isUploading(!0),t.hasError(!1),t.errorTitle(void 0),t.errorDescription(void 0)}).done(function(e){t.image(e)}).fail(function(e){t.image(void 0),t.hasError(!0),t.errorTitle(e.title),t.errorDescription(e.description)}).always(function(){t.image.isUploading(!1)})},t.clearImage=function(){t.image(null)},t.getData=function(){return{image:{src:t.image(),type:t.type()}}}}e.LogoModel=n,e.ThemesModel=t,e.ThemeModel=a,e.TrackingDataModel=o,e.LrsOption=r,e.LanguagesModel=i,e.LanguageModel=s,e.BackgroundModel=l}(window.app=window.app||{}),function(e){var n=null,t=null,a=(location.protocol+"//"+location.host,{trackingData:null,languages:null,logo:null,themes:null,masteryScore:ko.observable(100),userHasStarterPlan:ko.observable(!1)});a.getSettingsData=function(){return{logo:a.logo.getData(),background:a.background.getData(),xApi:a.trackingData.getData(),theme:a.themes.getData(),languages:a.languages.getData(),masteryScore:{score:a.masteryScore()}}},a.getExtraData=function(){return{}},a.saveChanges=function(){var o=a.getSettingsData(),r=a.getExtraData(),i=JSON.stringify(o),s=JSON.stringify(r);(JSON.stringify(n)!==i||JSON.stringify(t)!==s)&&window.egApi.saveSettings(i,s,e.localize("changes are saved"),e.localize("changes are not saved")).done(function(){n=o,t=r})},a.init=function(){var o=window.egApi;return o.init().then(function(){var r=o.getManifest(),i=o.getUser(),s=o.getSettings();i.accessType>0&&a.userHasStarterPlan(!0),s.masteryScore&&s.masteryScore.score&&s.masteryScore.score>=0&&s.masteryScore.score<=100&&a.masteryScore(s.masteryScore.score),a.trackingData=new e.TrackingDataModel(s.xApi),a.languages=new e.LanguagesModel(r.languages,s.languages),a.logo=new e.LogoModel(s.logo),a.themes=new e.ThemesModel(s.theme),a.background=new e.BackgroundModel(s.background),n=a.getSettingsData(),t=a.getExtraData()}).fail(function(){o.sendNotificationToEditor(e.localize("settings are not initialize"),!1)})},a.init().done(function(){$(document).ready(function(){ko.applyBindings(a,$(".settings-container")[0]),$(window).on("blur",a.saveChanges)})})}(window.app=window.app||{});