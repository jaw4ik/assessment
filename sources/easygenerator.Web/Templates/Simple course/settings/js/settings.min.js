$(function(){window.getTranslations=function(){return{en:[{key:"[course]",value:"Course:"},{key:"[start course]",value:"Start course"},{key:"[finish course]",value:"Finish course"},{key:"[learning objectives]",value:"Learning objectives:"},{key:"[start]",value:"Start"},{key:"[home]",value:"Home"},{key:"[learning content]",value:"Learning content"},{key:"[submit]",value:"Submit"},{key:"[try again]",value:"Try again"},{key:"[next]",value:"Next"},{key:"[correct answer]",value:"Correct answer"},{key:"[incorrect answer]",value:"Incorrect answer"},{key:"[previous question]",value:"previous"},{key:"[next question]",value:"next"},{key:"[of]",value:"of"},{key:"[to complete]",value:"to complete"},{key:"[text matching question hint]",value:"Drag items from right column to the left to match the pairs"},{key:"[text matching question drop here]",value:"Drop here"},{key:"[statement question true text]",value:"True"},{key:"[statement question false text]",value:"False"},{key:"[drag and drop question all texts are placed]",value:"All texts are placed"},{key:"[drag and drop question drop here]",value:"Drop here"},{key:"[fill in the blank choose answer]",value:"Choose the answer..."},{key:"[thank you message]",value:"Thank you, you can close the page now"},{key:"[save my current progress]",value:"Save my current progress"},{key:"[progress has been saved]",value:"Progress has been saved!"},{key:"[progress not saved]",value:'Your course progress has not been saved yet! If you want to save it:\n  1. Press "Stay on this Page"\n  2. Press "Save my current progress" in the top of the page of the course.\nOr Press "Leave this Page" to close the course without saving your progress.'},{key:"[progress cannot be saved]",value:"Course progress cannot be saved. Please try again or contact your teacher if the problem persists."},{key:"[there are no questions]",value:"No questions"},{key:"[browser not supported]",value:"Your browser is currently not supported."},{key:"[browser not supported hint]",value:"Don’t worry, there is an easy fix. All you have to do is click one of the icons below and follow the instructions."},{key:"[page not found title]",value:"Page not found (404)"},{key:"[page not found message]",value:"Sorry, the page you have been looking for has not been found. Try checking the URL on errors, use the navigation above or click 'Home' link below."},{key:"[tracking and tracing header]",value:"Your credentials for progress tracking"},{key:"[tracking and tracing hint]",value:'Please enter your credentials and click "Start and report my results "to enable result tracking. Otherwise, click "Do not report, just start".'},{key:"[tracking and tracing name field]",value:"Your name"},{key:"[tracking and tracing email field]",value:"Your e-mail"},{key:"[tracking and tracing name is not valid]",value:"Fill in your name"},{key:"[tracking and tracing email is not valid]",value:"Enter a valid e-mail"},{key:"[tracking and tracing skip reporting]",value:"Do not report, just start"},{key:"[tracking and tracing start]",value:"Start and report my results"},{key:"[tracking and tracing error]",value:"Something is wrong"},{key:"[tracking and tracing error hint]",value:"If you continue without restarting, your learning results will not be reported."},{key:"[tracking and tracing restart course]",value:"Restart course"},{key:"[tracking and tracing continue anyway]",value:"Continue anyway"},{key:"[tracking and tracing reporting progress]",value:"reporting results..."}],nl:[{key:"[course]",value:"Cursus:"},{key:"[start course]",value:"Start cursus"},{key:"[finish course]",value:"Stop cursus"},{key:"[learning objectives]",value:"Leerdoelen:"},{key:"[start]",value:"Start"},{key:"[home]",value:"Home"},{key:"[learning content]",value:"Leerstof"},{key:"[submit]",value:"Invoeren"},{key:"[try again]",value:"Probeer opnieuw"},{key:"[next]",value:"Volgende"},{key:"[correct answer]",value:"Juist antwoord"},{key:"[incorrect answer]",value:"Onjuist antwoord"},{key:"[previous question]",value:"Vorige"},{key:"[next question]",value:"Volgende"},{key:"[of]",value:"van"},{key:"[to complete]",value:"compleet"},{key:"[text matching question hint]",value:"Sleep items van de rechterkolom naar links om kloppende paren te maken"},{key:"[text matching question drop here]",value:"Plaats hier"},{key:"[statement question true text]",value:"Waar"},{key:"[statement question false text]",value:"Niet waar"},{key:"[drag and drop question all texts are placed]",value:"Alle teksten zijn geplaatst"},{key:"[drag and drop question drop here]",value:"Plaats hier"},{key:"[fill in the blank choose answer]",value:"Kies het antwoord…"},{key:"[thank you message]",value:"Bedankt, je kan nu de pagina sluiten"},{key:"[save my current progress]",value:"Sla mijn voortgang op"},{key:"[progress has been saved]",value:"Voortgang is opgeslagen!"},{key:"[progress not saved]",value:'Uw cursus voortgang is nog niet opgeslagen! Als u de voortgang wilt opslaan:\n  1. Druk op  "Op deze pagina blijven"\n  2. Kies "Bewaar mijn voortgang" bovenaan de pagina van de cursus.\nOf druk op "Deze pagina verlaten" om de cursus te sluiten zonder uw voortgang op te slaan.'},{key:"[progress cannot be saved]",value:"Cursus voortgang kan niet worden opgeslagen. Probeer het opnieuw of neem contact op met de docent als het probleem blijft bestaan."},{key:"[there are no questions]",value:"Geen vragen"},{key:"[browser not supported]",value:"Uw browser wordt niet ondersteund."},{key:"[browser not supported hint]",value:"Maak je geen zorgen er is een simpeleoplossing. Klik op een van de iconen beneden en volg de instructies"},{key:"[page not found title]",value:"Pagina niet gevonden (404)"},{key:"[page not found message]",value:"Sorry, de pagina is niet gevonden. Controleer de link of klik op home."},{key:"[tracking and tracing header]",value:"Je gegevens om de resultaten op te slaan"},{key:"[tracking and tracing hint]",value:"Vul je gegevens in en druk op 'Start en leg mijn resultaten vast'. Of klik op 'leg mijn resultaten niet vast'"},{key:"[tracking and tracing name field]",value:"Naam"},{key:"[tracking and tracing email field]",value:"Email"},{key:"[tracking and tracing name is not valid]",value:"Vul je naam in"},{key:"[tracking and tracing email is not valid]",value:"Voer een geldig email adres in"},{key:"[tracking and tracing skip reporting]",value:"Leg mijn resultaten niet vast"},{key:"[tracking and tracing start]",value:"Start en leg mijn resultaten vast"},{key:"[tracking and tracing error]",value:"Er is iets misgegaan"},{key:"[tracking and tracing error hint]",value:"Als je doorgaat worden je leerresultaten niet vastgelegd"},{key:"[tracking and tracing restart course]",value:"Herstart cursus"},{key:"[tracking and tracing continue anyway]",value:"Ga door"},{key:"[tracking and tracing reporting progress]",value:"Resultaten vastleggen..."}],ua:[{key:"[course]",value:"Курс :"},{key:"[start course]",value:"Почати курс"},{key:"[finish course]",value:"Закінчити курс"},{key:"[learning objectives]",value:"Мета навчання:"},{key:"[start]",value:"Почати"},{key:"[home]",value:"Головна"},{key:"[learning content]",value:"Навчальний матеріал"},{key:"[submit]",value:"Відповісти"},{key:"[try again]",value:"Спробувати ще"},{key:"[next]",value:"Далі"},{key:"[correct answer]",value:"Правильна відповідь"},{key:"[incorrect answer]",value:"Неправильна відповідь"},{key:"[previous question]",value:"Назад"},{key:"[next question]",value:"Вперед"},{key:"[of]",value:"з"},{key:"[to complete]",value:"для досягнення цілі"},{key:"[text matching question hint]",value:"Перетягніть відповіді з правої колонки до лівої таким чином, щоб вони відповідали визначенням з першої колонки"},{key:"[text matching question drop here]",value:"Сюди"},{key:"[statement question true text]",value:"Вірно"},{key:"[statement question false text]",value:"Невірно"},{key:"[drag and drop question all texts are placed]",value:"Усі тексти вже використані"},{key:"[drag and drop question drop here]",value:"Сюди"},{key:"[fill in the blank choose answer]",value:"Оберіть варіант..."},{key:"[thank you message]",value:"Дякуємо. Тепер сторінку можна закрити"},{key:"[save my current progress]",value:"Зберегти мій поточний прогрес"},{key:"[progress has been saved]",value:"Прогрес збережено!"},{key:"[progress not saved]",value:'Прогрес ще не був збережений! Якщо бажаєте зберегти його:\n  1. Натисніть "Залишатися на цій сторінці".\n  2. Натисніть "Зберегти мій поточний прогрес" в верхній частині сторінки курса.\nАбо натисніть "Залишити цю сторінку" щоб закрити курс без збереження прогресу.'},{key:"[progress cannot be saved]",value:"Прогрес по курсу не може бути збережено. Будь-ласка, зверніться до свого вчителя, якщо проблема не зникне."},{key:"[there are no questions]",value:"Питання відсутні"},{key:"[browser not supported]",value:"Ваш браузер не підтримується"},{key:"[browser not supported hint]",value:"Не хвилюйтеся, це легко виправити. Все, що вам потрібно - це натиснути на одну з іконок, розташованих нижче і дотримуватись інструкцій"},{key:"[page not found title]",value:"Сторінка не знайдена (404)"},{key:"[page not found message]",value:"Вибачте, але сторінку, яку ви шукали, не знайдено. Спробуйте перевірити URL на помилки, використати навігацію вище або посилання на головну сторінку нижче."},{key:"[tracking and tracing header]",value:"Ваші дані для відправки результатів"},{key:"[tracking and tracing hint]",value:'Будь-ласка, вкажіть необхідні дані та натисніть "Так, відстежувати мій прогрес" для того, щоб відправляти результати. Якщо Ви не бажаєте відстежувати прогрес, натисніть "Пропустити цей крок"'},{key:"[tracking and tracing name field]",value:"Ваше ім'я"},{key:"[tracking and tracing email field]",value:"Ваша електронна адреса"},{key:"[tracking and tracing name is not valid]",value:"Вкажіть Ваше ім'я"},{key:"[tracking and tracing email is not valid]",value:"Вкажіть дійсну електронну адресу"},{key:"[tracking and tracing skip reporting]",value:"Пропустити цей крок"},{key:"[tracking and tracing start]",value:"Так, відстежувати мій прогрес"},{key:"[tracking and tracing error]",value:"Помилка"},{key:"[tracking and tracing error hint]",value:"Натисніть 'Спробувати ще'. Якщо помилка повторюється і ви бажаєте продовжити курс без відправки результатів - натисніть 'Продовжити'."},{key:"[tracking and tracing restart course]",value:"Спробувати ще"},{key:"[tracking and tracing continue anyway]",value:"Продовжити"},{key:"[tracking and tracing reporting progress]",value:"Надсилаемо прогресс..."}],cn:[{key:"[course]",value:"课程："},{key:"[start course]",value:"开始课程"},{key:"[finish course]",value:"结束课程"},{key:"[learning objectives]",value:"学习目标："},{key:"[start]",value:"开始"},{key:"[home]",value:"主页"},{key:"[learning content]",value:"学习内容"},{key:"[submit]",value:"提交"},{key:"[try again]",value:"重试"},{key:"[next]",value:"下一步"},{key:"[correct answer]",value:"答案正确"},{key:"[incorrect answer]",value:"答案错误"},{key:"[previous question]",value:"前一页"},{key:"[next question]",value:"下一步"},{key:"[of]",value:"只"},{key:"[to complete]",value:"完成"},{key:"[text matching question hint]",value:"把选项从右列拖到左边以配对"},{key:"[text matching question drop here]",value:"放到这里"},{key:"[statement question true text]",value:"正确"},{key:"[statement question false text]",value:"错误"},{key:"[drag and drop question all texts are placed]",value:"所有文本归位"},{key:"[drag and drop question drop here]",value:"放到这里"},{key:"[fill in the blank choose answer]",value:"选择答案…"},{key:"[thank you message]",value:"谢谢，你现在可以关闭此页面。"},{key:"[there are no questions]",value:"没有问题"},{key:"[browser not supported]",value:"你的浏览器不支持"},{key:"[browser not supported hint]",value:"别担心，有简答的修复方法。你只需要点击下面的其中一个按钮，跟着提示操作就可以了。"},{key:"[page not found title]",value:"页面没找到（404）"},{key:"[page not found message]",value:"Sorry，你要找的页面没有发现。请检查URL是否有错误，请使用上面的导航栏或点击下面的“主页”链接。"},{key:"[tracking and tracing header]",value:"你的用来跟踪进度的证书"},{key:"[tracking and tracing hint]",value:"请输入你的证书然后点击“开始并报告我的结果”以启动结果跟踪，否则，点击“不报告，只是开始”。"},{key:"[tracking and tracing name field]",value:"你的姓名"},{key:"[tracking and tracing email field]",value:"你的e-mail"},{key:"[tracking and tracing name is not valid]",value:"输入你的姓名"},{key:"[tracking and tracing email is not valid]",value:"输入有效的e-mail"},{key:"[tracking and tracing skip reporting]",value:"不报告，只是开始"},{key:"[tracking and tracing start]",value:"开始并报告我的结果"},{key:"[tracking and tracing error]",value:"出错了"},{key:"[tracking and tracing error hint]",value:"如果你不重新开始，仍然继续，你的学习结果将不会被报告。"},{key:"[tracking and tracing restart course]",value:"重新开始课程"},{key:"[tracking and tracing continue anyway]",value:"仍然继续"},{key:"[tracking and tracing reporting progress]",value:"正在报告结果"}],it:[{key:"[course]",value:"Corso"},{key:"[start course]",value:"Inizio del corso"},{key:"[finish course]",value:"Fine del corso"},{key:"[learning objectives]",value:"Obiettivi di apprendimento"},{key:"[start]",value:"Inizio"},{key:"[home]",value:"Home"},{key:"[learning content]",value:"Contenuto"},{key:"[submit]",value:"Invia"},{key:"[try again]",value:"Riprova"},{key:"[next]",value:"Prossimo"},{key:"[correct answer]",value:"Risposta corretta"},{key:"[incorrect answer]",value:"Risposta incorretta"},{key:"[previous question]",value:"precedente"},{key:"[next question]",value:"prossimo"},{key:"[of]",value:"su"},{key:"[to complete]",value:"da completare"},{key:"[text matching question hint]",value:"Trascina gli oggetti da destra a sinistra e abbina le coppie corrette"},{key:"[text matching question drop here]",value:"Rilascia qui"},{key:"[statement question true text]",value:"VERO"},{key:"[statement question false text]",value:"FALSO"},{key:"[drag and drop question all texts are placed]",value:"Tutti i testi sono settati"},{key:"[drag and drop question drop here]",value:"Rilascia qui"},{key:"[fill in the blank choose answer]",value:"Scegli una risposta"},{key:"[thank you message]",value:"Grazie. Ora puoi chiudere la pagina."},{key:"[there are no questions]",value:"Non ci sono domande"},{key:"[browser not supported]",value:"Questo browser non è al momento supportato."},{key:"[browser not supported hint]",value:"Clicca le icone in basso e segui le istruzioni."},{key:"[page not found title]",value:"Pagina non trovata [404]"},{key:"[page not found message]",value:"Siamo spiacenti. La pagina cercata non è stata trovata. Controlla se ci sono errori nell'URL, utilizza la barra di navigazione sopra o clicca il link 'Home' sotto."},{key:"[tracking and tracing header]",value:"Le tue credenziali per tenere traccia dei progressi"},{key:"[tracking and tracing hint]",value:"Inserisci le tue credenziali e clicca “Comincia e tieni traccia dei miei risultati” abilita la tracciatura. Oppure clicca “Inizia senza verificare”."},{key:"[tracking and tracing name field]",value:"Nome"},{key:"[tracking and tracing email field]",value:"Indirizzo e-mail"},{key:"[tracking and tracing name is not valid]",value:"Completa con il tuo nome"},{key:"[tracking and tracing email is not valid]",value:"Inserisci un indirizzo e-mail valido"},{key:"[tracking and tracing skip reporting]",value:"Inizia senza verificare"},{key:"[tracking and tracing start]",value:"Comincia e tieni traccia dei miei risultati"},{key:"[tracking and tracing error]",value:"Qualcosa non funziona"},{key:"[tracking and tracing error hint]",value:"Se continui senza riavviare, i tuoi risultati di apprendimento non saranno registrati."},{key:"[tracking and tracing restart course]",value:"Riavvia il corso"},{key:"[tracking and tracing continue anyway]",value:"Continua lo stesso"},{key:"[tracking and tracing reporting progress]",value:"reporting results..."}]}}}),$(function(){function e(e){return decodeURI((RegExp(e+"=(.+?)(&|$)").exec(location.search)||[,null])[1])}function a(e,a){var t=e.name.toLowerCase(),n=a.name.toLowerCase();return n>t?-1:t>n?1:0}var t=e("courseId"),n=e("templateId"),r=location.protocol+"//"+location.host,i=r+"/api/course/"+t+"/template/"+n,o=location.toString().indexOf("/settings/settings"),s=location.toString().substring(0,o),l=1,u=window.getTranslations(),c=[{key:"cn",name:"Chinese"},{key:"en",name:"English"},{key:"it",name:"Italian"},{key:"nl",name:"Dutch"},{key:"ua",name:"Ukrainian"}];c=c.sort(a),c.push({key:"xx",name:"Custom"});var d={trackingData:function(){var e={};return e.enableXAPI=ko.observable(!0),e.lrsOptions=[{key:"default",text:"easygenerator (recommended)"},{key:"custom",text:"Custom LRS"}],e.selectedLrs=ko.observable(e.lrsOptions[0].key),ko.utils.arrayMap(e.lrsOptions,function(a){return a.isSelected=ko.computed({read:function(){return e.selectedLrs()==a.key},write:function(){}}),a.select=function(){ko.utils.arrayForEach(e.lrsOptions,function(e){e.isSelected(!1)}),a.isSelected(!0),e.selectedLrs(a.key)},a}),e.customLrsEnabled=ko.computed(function(){return e.enableXAPI()&&e.selectedLrs()!=e.lrsOptions[0].key}),e.lrsUrl=ko.observable(""),e.authenticationRequired=ko.observable(!1),e.lapLogin=ko.observable(),e.lapPassword=ko.observable(),e.credentialsEnabled=ko.computed(function(){return e.customLrsEnabled()&&e.authenticationRequired()}),e.statements={started:ko.observable(!0),stopped:ko.observable(!0),experienced:ko.observable(!0),mastered:ko.observable(!0),answered:ko.observable(!0),passed:ko.observable(!0),failed:ko.observable(!0)},e}(),isSaved:ko.observable(!1),isFailed:ko.observable(!1),advancedSettingsExpanded:ko.observable(!1),toggleAdvancedSettings:function(){this.advancedSettingsExpanded(!this.advancedSettingsExpanded())},logo:function(){var e={};return e.url=ko.observable("").extend({throttle:300}),e.hasLogo=ko.computed(function(){return""!==e.url()}),e.clear=function(){e.url("")},e.isError=ko.observable(!1),e.errorText=ko.observable(""),e.errorDescription=ko.observable(""),e.isLoading=ko.observable(!1),e}(),themes:function(){var e={};return e.list=[{title:"Cartoon light",key:"cartoon"},{title:"Grey scheme",key:"grey"},{title:"Black scheme",key:"black"},{title:"Flat scheme",key:"flat"}],e.default="cartoon",e.selected=ko.observable(""),ko.utils.arrayMap(e.list,function(a){return a.isSelected=ko.observable(!1),a.select=function(){ko.utils.arrayForEach(e.list,function(e){e.isSelected(!1)}),a.isSelected(!0),e.selected(a.key)},a}),e.setSelected=function(a){var t=ko.utils.arrayFirst(e.list,function(e){return e.key==a});t&&t.select()},e.setSelected(e.default),e.openDemo=function(){window.open(s+"?v="+(new Date).getTime()+"&theme="+e.selected(),"_blank")},e}(),defaultTranslations:$.extend(u,{xx:$.map(u.en,function(e){return{key:e.key,value:ko.observable(e.value)}})}),languages:c,hasStarterPlan:ko.observable(!0),masteryScore:ko.observable("")};d.escapeHtml=function(e){return $("<div/>").text(e).html()},d.unescapeHtml=function(e){return $("<div/>").html(e).text()},d.selectedLanguage=ko.observable("en"),d.isCustom=ko.computed(function(){var e=d.selectedLanguage();return"xx"==e}),d.translations=ko.computed(function(){return d.defaultTranslations[d.selectedLanguage()]}),d.getCustomTranslations=function(){return d.defaultTranslations.xx},d.saveChanges=function(){var e={logo:{url:d.logo.url()},xApi:{enabled:d.trackingData.enableXAPI(),selectedLrs:d.trackingData.selectedLrs(),lrs:{uri:d.trackingData.lrsUrl(),authenticationRequired:d.trackingData.authenticationRequired(),credentials:{username:d.trackingData.lapLogin(),password:d.trackingData.lapPassword()}},allowedVerbs:$.map(d.trackingData.statements,function(e,a){return e()?a:void 0})},masteryScore:{score:d.masteryScore()},theme:{key:d.themes.selected()},translations:$.map(d.defaultTranslations[d.selectedLanguage()],function(e){return{key:e.key,value:d.escapeHtml(d.isCustom()?e.value():e.value)}})};d.isFailed(!1),d.isSaved(!1);var a={selectedLanguage:d.selectedLanguage(),customTranslations:$.map(d.getCustomTranslations(),function(e){return{key:e.key,value:d.escapeHtml(e.value())}})};$.post(i,{settings:JSON.stringify(e),extraData:JSON.stringify(a)}).done(function(){d.isSaved(!0)}).fail(function(){d.isFailed(!0)})},ko.bindingHandlers.fadeVisible={init:function(e,a){var t=a();$(e).toggle(ko.unwrap(t))},update:function(e,a){var t=a();ko.unwrap(t)?$(e).fadeIn():$(e).fadeOut()}},ko.bindingHandlers.number={init:function(e){var a=$(e),t=100;a.on("keydown",function(e){var a=e.charCode||e.keyCode||0;return 8==a||9==a||46==a||a>=37&&40>=a||a>=48&&57>=a||a>=96&&105>=a}),a.on("keyup",function(){$(this).val()>t&&$(this).val(t)})}},ko.bindingHandlers.disableDragNDrop={init:function(e){$(e).on("dragstart",function(e){e.preventDefault()})}},ko.bindingHandlers.spinner={init:function(e,a){var t=a();$(e).spinner("changed",function(e,a){t(a)})}},ko.bindingHandlers.switchToggle={init:function(e,a){var t=ko.bindingHandlers.switchToggle,n=t.viewModel(e,a),r=ko.unwrap(a().value());n.setInitialValue(r),t.onClick(e,function(){n.toggle();var e=ko.unwrap(a().value());a().value(!e)})},update:function(e,a){var t=ko.bindingHandlers.switchToggle.viewModel(e,a),n=ko.unwrap(a().value());t.updateValue(n)},viewModel:function(e){function a(e){i(e),o(e)}function t(){var e=n();i(!e),u.stop().animate({marginLeft:s(!e)},250)}function n(){return l.hasClass("on")}function r(e){n()!=e&&a(e)}function i(e){l.toggleClass("on",e),l.toggleClass("off",!e)}function o(e){u.css("margin-left",s(e)+"px")}function s(e){return e?0:l.height()-l.width()}var l=$(e),u=$(".switch-toggle-wrapper",l);return{setInitialValue:a,updateValue:r,toggle:t}},onClick:function(e,a){var t=$(e),n=!1;t.mousedown(function(e){1==e.which&&(n=!0,a())}),t.click(function(){return n?void(n=!1):void a()})}},ko.bindingHandlers.dropdown={cssClasses:{dropdown:"dropdown",disabled:"disabled",expanded:"expanded",optionsList:"dropdown-options-list",optionItem:"dropdown-options-item",currentItem:"dropdown-current-item",currentItemText:"dropdown-current-item-text",indicatorHolder:"dropdown-indicator-holder",indicator:"dropdown-indicator"},init:function(e){var a=$(e),t=ko.bindingHandlers.dropdown.cssClasses;a.addClass(t.dropdown);var n=$("<div />").addClass(t.currentItem).appendTo(a);$("<div />").addClass(t.currentItemText).appendTo(n);var r=$("<div />").addClass(t.indicatorHolder).appendTo(n);$("<span />").addClass(t.indicator).appendTo(r),$("<ul />").addClass(t.optionsList).appendTo(a),n.on("click",function(e){a.hasClass(t.disabled)||(n.toggleClass(t.expanded),e.stopPropagation())});var i=function(){n.removeClass(t.expanded)};$("html").bind("click",i),$(window).bind("blur",i),ko.utils.domNodeDisposal.addDisposeCallback(e,function(){$("html").unbind("click",i),$(window).unbind("blur",i)})},update:function(e,a){var t=$(e),n=ko.bindingHandlers.dropdown.cssClasses,r=t.find("ul."+n.optionsList),i=t.find("div."+n.currentItemText),o=a().options,s=a().optionsText,l=a().value,u=a().optionsValue,c=ko.unwrap(l),d=ko.unwrap(a().disable);d?t.toggleClass(n.disabled):t.removeClass(n.disabled),r.empty(),$.each(o,function(e,a){return a[u]==c?void i.text(a[s]):void $("<li />").addClass(n.optionItem).appendTo(r).text(a[s]).on("click",function(){l(a[u]),t.trigger("change")})})}},ko.bindingHandlers.tabs={init:function(e){var a=$(e),t="data-tab-link",n="data-tab",r="active",i=a.find("["+t+"]"),o=a.find("["+n+"]");o.hide(),i.first().addClass(r),o.first().show(),i.each(function(e,s){var l=$(s);l.on("click",function(){var e=l.attr(t),s=a.find("["+n+'="'+e+'"]');i.removeClass(r),l.addClass(r),o.hide(),s.show()})})}},ko.applyBindings(d,$("#settingsForm")[0]);var g={apiUrl:r+"/storage/image/upload",maxFileSize:10,supportedExtensions:["jpeg","jpg","png","bmp","gif"],somethingWentWrongMessage:{title:"Something went wrong",description:"Please, try again"},status:{"default":function(){d.logo.isLoading(!1),d.logo.isError(!1)},fail:function(e){d.logo.clear(),d.logo.isLoading(!1),d.logo.errorText(e.title),d.logo.errorDescription(e.description),d.logo.isError(!0)},loading:function(){d.logo.isLoading(!0)}},button:{enable:function(){this.$input.attr("disabled",!1).closest(".image-upload-button").removeClass("disabled")},disable:function(){this.$input.attr("disabled",!0).closest(".image-upload-button").addClass("disabled")},submit:function(){this.$input[0].form.submit(),this.disable(),g.status.loading()},$input:$("#logoInput")},init:function(){g.button.$input.on("change",g.processFile),g.button.enable()},processFile:function(){if(!this.files)return void g.button.submit();if(0!==this.files.length){var e=this.files[0],a=e.name.split(".").pop().toLowerCase();return-1===$.inArray(a,g.supportedExtensions)?void g.status.fail({title:"Unsupported image format",description:"(Allowed formats: "+g.supportedExtensions.join(", ")+")"}):e.size>1024*g.maxFileSize*1024?void g.status.fail({title:"File is too large",description:"(Max file size: "+g.maxFileSize+"MB)"}):void g.uploadFile(e)}},uploadFile:function(e){g.button.disable(),g.status.loading();var a=new FormData;a.append("file",e),$.ajax({url:g.apiUrl,type:"POST",data:a,cache:!1,dataType:"json",processData:!1,contentType:!1}).done(function(e){g.handleResponse(e)}).fail(function(){g.status.fail(g.somethingWentWrongMessage),g.button.enable()})},handleResponse:function(e){try{if(!e)throw"Response is empty";if("object"!=typeof e&&(e=JSON.parse(e)),!e||!e.success||!e.data)throw"Request is not success";d.logo.url(e.data.url),g.status.default()}catch(a){g.status.fail(g.somethingWentWrongMessage)}finally{g.button.enable()}}};$.ajax({cache:!1,url:i,dataType:"json",success:function(e){var a,t,n={logo:{},xApi:{enabled:!0,selectedLrs:"default",lrs:{credentials:{}}},masteryScore:{}},r={customTranslations:[]};try{a=JSON.parse(e.settings)||n}catch(i){a=n}try{t=JSON.parse(e.extraData)||r}catch(i){t=r}d.trackingData.enableXAPI(a.xApi.enabled||!1);var o=a.xApi.enabled?"custom":"default";d.trackingData.selectedLrs(a.xApi.selectedLrs||o),d.trackingData.lrsUrl(a.xApi.lrs.uri||""),d.trackingData.authenticationRequired(a.xApi.lrs.authenticationRequired||!1),d.trackingData.lapLogin(a.xApi.lrs.credentials.username||""),d.trackingData.lapPassword(a.xApi.lrs.credentials.password||""),a.xApi.allowedVerbs&&$.each(d.trackingData.statements,function(e,t){t($.inArray(e,a.xApi.allowedVerbs)>-1)}),d.logo.url(a.logo.url||""),d.masteryScore("undefined"!=typeof a.masteryScore&&a.masteryScore.score>=0&&a.masteryScore.score<=100?a.masteryScore.score:100),a.theme&&a.theme.key&&d.themes.setSelected(a.theme.key);var s=d.getCustomTranslations();return 0==t.customTranslations.length&&null!=a.translations?($.each(a.translations,function(e){$.each(s,function(t){a.translations[e].key===s[t].key&&s[t].value(d.unescapeHtml(a.translations[e].value))})}),void d.selectedLanguage("xx")):($.each(t.customTranslations,function(e){$.each(s,function(a){t.customTranslations[e].key===s[a].key&&s[a].value(d.unescapeHtml(t.customTranslations[e].value))})}),void(null!=t.selectedLanguage&&void 0!=t.selectedLanguage&&d.selectedLanguage(t.selectedLanguage)))},error:function(){d.masteryScore(100)}}),$.ajax({url:r+"/api/identify",type:"POST",contentType:"application/json",dataType:"json",success:function(e){if(e.hasOwnProperty("subscription")&&e.subscription.hasOwnProperty("accessType")){var a=e.subscription.accessType>=l&&new Date(e.subscription.expirationDate)>=new Date;d.hasStarterPlan(a),a&&g.init()}else d.hasStarterPlan(!1)},error:function(){d.hasStarterPlan(!1)}})});