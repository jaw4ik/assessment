!function(e){e.localize=function(e){return o[e]};var o={cartoon:"Cartoon light",grey:"Grey scheme",black:"Black scheme",flat:"Flat scheme","changes are saved":"All changes are saved","changes are not saved":"Changes have NOT been saved. Please reload the page and change the settings again. Contact support@easygenerator.com if problem persists.","settings are not initialize":"Template settings are not initialized. Please reload the page and change the settings again. Contact support@easygenerator.com if problem persists.","graphical customization":"Graphical customization","results tracking":"Results Tracking","template language":"Template language","customize your course":"Customize your course","look and feel of the course":"Change the look and feel of the course","custom course logo":"Custom course logo:",or:"or","upload logo image":"Upload logo image","logo hint":"Your logo will appear here<p>(recommended size 300 x 50 px)</p>","clear logo":"Clear logo","choose color scheme":"Choose color scheme:","upgrade account hint":'You have to <a target="_blank" href="/account/upgrade">upgrade your account</a> in order to set custom course logo',"background change":"Change background","background update":"Change background","background remove":"Clear background","background default":"Default","background repeat":"Repeat","background fullscreen":"Fullscreen","background upgrade account hint":'You have to <a target="_blank" href="/account/upgrade">upgrade your account</a> in order to set custom course background'}}(window.app=window.app||{}),function(e){function o(e){var o=e.name.split(".").pop().toLowerCase();return-1===$.inArray(o,a.supportedExtensions)?{title:"Unsupported image format",description:"(Allowed formats: "+a.supportedExtensions.join(", ")+")"}:e.size>1024*a.maxFileSize*1024?{title:"File is too large",description:"(Max file size: "+a.maxFileSize+"MB)"}:!0}var n=location.protocol+"//"+location.host+"/storage/image/upload",t={title:"Something went wrong",description:"Please, try again"},a={maxFileSize:10,supportedExtensions:["jpeg","jpg","png","bmp","gif"]};e.upload=function(e){var r=$.Deferred(),i=$("<form>").hide().attr("method","post").attr("enctype","multipart/form-data").insertAfter("body"),s=$("<input>").attr("accept",a.supportedExtensions.map(function(e){return"."+e}).join(", ")).attr("type","file").attr("name","file").on("change",function(){e&&e();var a=this.files[0],i=o(a);if(i!==!0)return void r.reject(i);var s=new FormData;s.append("file",a),$.ajax({url:n,type:"POST",data:s,contentType:!1,processData:!1}).done(function(e){try{var o=JSON.parse(e);o&&o.success&&o.data&&o.data.url?r.resolve(o.data.url):r.reject(t)}catch(n){r.reject(t)}}).fail(function(){r.reject(t)})}).appendTo(i);return s.click(),r.promise()}}(window.app=window.app||{}),function(){ko.bindingHandlers.fadeVisible={init:function(e,o){var n=o();$(e).toggle(ko.unwrap(n))},update:function(e,o){var n=o();ko.unwrap(n)?$(e).fadeIn():$(e).fadeOut()}},ko.bindingHandlers.localize={init:function(e,o){var n=$(e),t=ko.unwrap(o());n.html(app.localize(t))}},ko.bindingHandlers.background={init:function(e){$(e).css("background-size","cover").css("background-position","center").css("background-repeat","no-repeat")},update:function(e,o){var n=ko.unwrap(o());if($(e).css("background-image","none"),n){var t=new Image;t.onload=function(){$(e).css("background-image","url("+n+")")},t.src=n}}}}(),function(e){function o(e){this.hasStarterPlan=e&&e.accessType>0}function n(o){function n(e){e&&u.setUrl(e.url)}function t(){u.isLoading()||e.upload(function(){i()}).done(function(e){s(e),a()}).fail(function(e){r(e.title,e.description)})}function a(){u.isLoading(!1),u.isError(!1)}function r(e,o){u.clear(),u.isLoading(!1),u.errorText(e),u.errorDescription(o),u.isError(!0)}function i(){u.isLoading(!0)}function s(e){u.url(e||"")}function c(){return{url:u.url()}}var u=this;return u.url=ko.observable(""),u.hasLogo=ko.computed(function(){return""!==u.url()}),u.clear=function(){u.url("")},u.isError=ko.observable(!1),u.errorText=ko.observable(""),u.errorDescription=ko.observable(""),u.isLoading=ko.observable(!1),u.setUrl=s,u.getData=c,u.upload=t,n(o),u}function t(o){function n(e){e&&s.selectByName(e.key)}function t(e){ko.utils.arrayForEach(s.list,function(e){e.isSelected(!1)}),e.isSelected(!0)}function a(e){ko.utils.arrayForEach(s.list,function(o){o.isSelected(o.name===e)})}function r(){var e=location.toString().indexOf("/settings/settings"),o=location.toString().substring(0,e),n=["v="+(new Date).getTime(),"theme="+s.selectedThemeName()].join("&");window.open(o+"?"+n,"_blank")}function i(){return{key:s.selectedThemeName()}}var s=this;return s.list=[new e.ThemeModel("cartoon",!0),new e.ThemeModel("grey"),new e.ThemeModel("black"),new e.ThemeModel("flat")],s.selectedThemeName=ko.computed(function(){var e="";return ko.utils.arrayForEach(s.list,function(o){o.isSelected()&&(e=o.name)}),e},s),s.select=t,s.selectByName=a,s.openDemo=r,s.getData=i,n(o),s}function a(e,o){var n=this;return n.name=e,n.isSelected=ko.observable(o===!0),n}function r(o){o=o||{image:{src:null,type:"default"}};var n=this;n.image=ko.observable(o.image.src),n.image.isUploading=ko.observable(!1),n.image.isEmpty=ko.computed(function(){return!(n.image()&&n.image().length>0)}),n.type=ko.observable(o.image.type),n.type["default"]=function(){n.type("default")},n.type.repeat=function(){n.type("repeat")},n.type.fullscreen=function(){n.type("fullscreen")},n.errorTitle=ko.observable(),n.errorDescription=ko.observable(),n.hasError=ko.observable(!1),n.changeImage=function(){n.image.isUploading()||e.upload(function(){n.image.isUploading(!0),n.hasError(!1),n.errorTitle(void 0),n.errorDescription(void 0)}).done(function(e){n.image(e)}).fail(function(e){n.image(void 0),n.hasError(!0),n.errorTitle(e.title),n.errorDescription(e.description)}).always(function(){n.image.isUploading(!1)})},n.clearImage=function(){n.image(null)},n.getData=function(){return{image:{src:n.image(),type:n.type()}}}}e.UserAccessModel=o,e.LogoModel=n,e.ThemesModel=t,e.ThemeModel=a,e.BackgroundModel=r}(window.app=window.app||{}),function(e){var o=null,n=null,t={userAccess:null,logo:null,themes:null,background:null};t.getCurrentSettingsData=function(e){return $.extend({},e||o,{logo:t.logo.getData(),theme:t.themes.getData(),background:t.background.getData()})},t.getCurrentExtraData=function(){return{}},t.saveChanges=function(){var a=t.getCurrentSettingsData(),r=t.getCurrentExtraData(),i=JSON.stringify(a),s=JSON.stringify(r);(JSON.stringify(o)!==i||JSON.stringify(n)!==s)&&window.egApi.saveSettings(i,s,e.localize("changes are saved"),e.localize("changes are not saved")).done(function(){o=a,n=r})},t.init=function(){var a=window.egApi;return a.init().then(function(){var r=a.getUser(),i=a.getSettings();t.userAccess=new e.UserAccessModel(r),t.logo=new e.LogoModel(i.logo),t.themes=new e.ThemesModel(i.theme),t.background=new e.BackgroundModel(i.background),o=t.getCurrentSettingsData(i),n=t.getCurrentExtraData()}).fail(function(){a.sendNotificationToEditor(e.localize("settings are not initialize"),!1)})},t.init().done(function(){$(document).ready(function(){ko.applyBindings(t,$(".settings-container")[0]),$(window).on("blur",t.saveChanges)})})}(window.app=window.app||{});