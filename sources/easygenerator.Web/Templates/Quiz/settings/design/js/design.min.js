!function(){"use strict";function t(t,e,n){function r(){var t=i();angular.equals(a,t)||u.saveSettings(JSON.stringify(t),null).done(function(){a=t})}function i(t){return $.extend({},t||a,{logo:{url:o.logo.url}})}var o=t,a=null,u=window.egApi;return o.userAccess=function(){function t(t){e.hasStarterPlan=t.accessType>0}var e={};return e.hasStarterPlan=!0,e.init=t,e}(),o.logo=function(){function t(){return""!==s.url}function e(){s.url=""}function r(t){s.url="",t&&t.url&&(s.url=t.url)}function i(){c||n(function(){a()}).done(function(t){s.url=t,u()}).fail(function(t){l(t.title,t.description)}).always(function(){o.$apply()})}function a(){c=!0}function u(){c=!1,s.hasError=!1}function l(t,e){c=!1,s.clear(),s.errorText=t,s.errorDescription=e,s.hasError=!0}var s={},c=!1;return s.url="",s.hasError=!1,s.errorText="Unsupported image format",s.errorDescription="(Supported formats: jpg, png, bmp)",s.hasLogo=t,s.clear=e,s.upload=i,s.init=r,s}(),angular.element(e).on("blur",r),u.init().then(function(){var t=u.getUser(),e=u.getSettings();o.userAccess.init(t),o.logo.init(e.logo),a=i(e),o.$applyAsync()}).fail(function(){u.sendNotificationToEditor("Settings are not initialized.",!1)})}angular.module("design",[]).controller("DesignController",["$scope","$window","upload",t])}(),function(){"use strict";function t(){return{restrict:"A",scope:{fadeVisibleValue:"="},link:function(t,e){var n=$(e);n.toggle(t.fadeVisibleValue),t.$watch("fadeVisibleValue",function(t){t?n.fadeIn():n.fadeOut()})}}}angular.module("design").directive("fadeVisible",t)}(),function(){"use strict";function t(){var t=location.protocol+"//"+location.host+"/storage/image/upload",e={title:"Something went wrong",description:"Please, try again"},n={maxFileSize:10,supportedExtensions:["jpeg","jpg","png","bmp","gif"]};return function(r){function i(t){var e=t.name.split(".").pop().toLowerCase();return-1===$.inArray(e,n.supportedExtensions)?{title:"Unsupported image format",description:"(Allowed formats: "+n.supportedExtensions.join(", ")+")"}:t.size>1024*n.maxFileSize*1024?{title:"File is too large",description:"(Max file size: "+n.maxFileSize+"MB)"}:!0}var o=$.Deferred(),a=$("<form>").hide().attr("method","post").attr("enctype","multipart/form-data").insertAfter("body"),u=$("<input>").attr("accept",n.supportedExtensions.map(function(t){return"."+t}).join(", ")).attr("type","file").attr("name","file").on("change",function(){r&&r();var n=this.files[0],a=i(n);if(a!==!0)return void o.reject(a);var u=new FormData;u.append("file",n),$.ajax({url:t,type:"POST",data:u,contentType:!1,processData:!1}).done(function(t){try{var n=JSON.parse(t);n&&n.success&&n.data&&n.data.url?o.resolve(n.data.url):o.reject(e)}catch(r){o.reject(e)}}).fail(function(){o.reject(e)})}).appendTo(a);return u.click(),o.promise()}}angular.module("design").factory("upload",t)}();