!function(){"use strict";function e(e,n,t){function r(){var e=a();angular.equals(o,e)||s.saveSettings(JSON.stringify(e),null).done(function(){o=e})}function a(e){return $.extend({},e||o,{xApi:i.trackingData.getData(),masteryScore:i.masteryScore.getData(),languages:i.languages.getData(),timer:i.timer.getData(),questionPool:i.questionPool.getData()})}var i=e,o=null,s=window.egApi;return i.isError=!1,i.trackingData=function(){function e(){return i.enableXAPI&&i.selectedLrs!==i.lrsOptions[0].key}function n(){return i.customLrsEnabled()&&i.authenticationRequired}function t(){i.advancedSettingsExpanded=!i.advancedSettingsExpanded}function r(e){i.enableXAPI=e.enabled||!1,i.allowToSkipTracking=!e.required;var n=e.enabled?"custom":"default";i.selectedLrs=e.selectedLrs||n,i.lrsUrl=e.lrs.uri||"",i.authenticationRequired=e.lrs.authenticationRequired||!1,i.lapLogin=e.lrs.credentials.username||"",i.lapPassword=e.lrs.credentials.password||"";var t;if(e.allowedVerbs)for(t in i.statements)i.statements.hasOwnProperty(t)&&(i.statements[t]=e.allowedVerbs.indexOf(t)>-1)}function a(){return{enabled:i.enableXAPI,required:!i.allowToSkipTracking,selectedLrs:i.selectedLrs,lrs:{uri:i.lrsUrl,authenticationRequired:i.authenticationRequired,credentials:{username:i.lapLogin,password:i.lapPassword}},allowedVerbs:$.map(i.statements,function(e,n){return e?n:void 0})}}var i={};return i.enableXAPI=!0,i.allowToSkipTracking=!1,i.lrsOptions=[{key:"default",text:"easygenerator (recommended)"},{key:"custom",text:"custom LRS"}],i.selectedLrs=i.lrsOptions[0].key,i.lrsOptions.forEach(function(e){e.isSelected=function(){return i.selectedLrs===e.key},e.select=function(){i.lrsOptions.forEach(function(e){e.isSelected(!1)}),e.isSelected(!0),i.selectedLrs=e.key}}),i.customLrsEnabled=e,i.lrsUrl="",i.authenticationRequired=!1,i.lapLogin="",i.lapPassword="",i.credentialsEnabled=n,i.statements={started:!0,stopped:!0,experienced:!0,mastered:!0,answered:!0,passed:!0,failed:!0},i.advancedSettingsExpanded=!1,i.toggleAdvancedSettings=t,i.init=r,i.getData=a,i}(),i.masteryScore=function(){function e(e){t.value=e&&e.score>=0&&e.score<=100?e.score:100}function n(){return{score:t.value||0}}var t={};return t.value=0,t.init=e,t.getData=n,t}(),i.languages=function(){function e(){var e=a(d);return e?e.resources:{}}function n(e,n){e.forEach(function(e){s.languagesList.push(new o(e.code,e.name,e.url,!1))});var t=a(u),r=new o(d,"Custom",t?t.resourcesUrl:null,!0,n?n.customTranslations:null);s.languagesList.push(r),s.selectedLanguageCode=n&&n.selected?n.selected:u}function r(){return{selected:s.selectedLanguageCode,customTranslations:s.getCustomTranslations()}}function a(e){return t("filter")(s.languagesList,{code:e})[0]}function o(e,n,t,r,a){function i(){return u?$.when():s(d.resourcesUrl).then(function(e){d.resources=$.isEmptyObject(d.resources)?e:o(d.resources,e),u=!0})}function o(e,n){var t={};return $.each(n,function(n,r){t[n]="string"==typeof e[n]?e[n]:r}),t}function s(e){return $.ajax({url:e,dataType:"json",contentType:"application/json"})}var u=!1,d=this;d.code=e,d.name=n,d.isEditable=r,d.resourcesUrl=t,d.resources=a||{},d.load=i}var s={},u="en",d="xx";return s.languagesList=[],s.selectedLanguageCode="",s.selectedLanguage=null,s.getCustomTranslations=e,s.init=n,s.getData=r,i.$watch("languages.selectedLanguageCode",function(){var e=a(s.selectedLanguageCode);e&&e.load().then(function(){s.selectedLanguage=e,i.$applyAsync()})}),s}(),i.timer=function(){function e(e){e&&e.time&&(t.enabled=e.enabled,t.hours=e.time.hours,t.minutes=e.time.minutes,t.seconds=e.time.seconds)}function n(){return{enabled:t.enabled,time:{hours:t.hours,minutes:t.minutes,seconds:t.seconds}}}var t={};return t.enabled=!1,t.hours=0,t.minutes=30,t.seconds=0,t.init=e,t.getData=n,t}(),i.questionPool=function(){function e(e){e&&(t.mode=e.mode,t.subsetSize=e.subsetSize,t.randomizeOrder=e.randomizeOrder,t.randomizePerAttempt=e.randomizePerAttempt)}function n(){var e={};return e.mode=t.mode,e.subsetSize=t.subsetSize,t.mode===t.modes.all?(e.randomizeOrder=t.randomizeOrder,e.randomizePerAttempt=t.randomizeOrder&&t.randomizePerAttempt):t.mode===t.modes.subset&&(e.randomizeOrder=t.randomizePerAttempt,e.randomizePerAttempt=t.randomizePerAttempt),e}var t={};return t.modes={all:"all",subset:"subset"},t.mode=t.modes.all,t.subsetSize=10,t.randomizeOrder=!0,t.randomizePerAttempt=!1,t.init=e,t.getData=n,t}(),angular.element(n).on("blur",r),s.init().then(function(){var e=s.getManifest(),n=s.getSettings();i.trackingData.init(n.xApi),i.masteryScore.init(n.masteryScore),i.languages.init(e.languages,n.languages),i.timer.init(n.timer),i.questionPool.init(n.questionPool),o=a(n)}).fail(function(){i.isError=!0}).always(function(){i.$applyAsync()})}angular.module("configure",[]).controller("ConfigureController",["$scope","$window","$filter",e])}(),function(){"use strict";function e(){return{restrict:"A",link:function(e,n){var t=$(n),r="data-tab-link",a="data-tab",i="active",o=t.find("["+r+"]"),s=t.find("["+a+"]");s.hide(),o.first().addClass(i),s.first().show(),o.each(function(e,n){var u=$(n);u.on("click",function(){var e=u.attr(r),n=t.find("["+a+'="'+e+'"]');o.removeClass(i),u.addClass(i),s.hide(),n.show()})})}}}function n(){return{restrict:"A",scope:{toggleValue:"="},link:function(e,n){function t(){function e(e){i(e),o(e)}function n(){var e=t();i(!e),u.stop().animate({marginLeft:s(!e)},250)}function t(){return a.hasClass("on")}function r(n){t()!==n&&e(n)}function i(e){a.toggleClass("on",e),a.toggleClass("off",!e)}function o(e){u.css("margin-left",s(e)+"px")}function s(e){return e?0:a.height()-a.width()}var u=$(".switch-toggle-wrapper",a);return{setInitialValue:e,updateValue:r,toggle:n}}function r(e){var n=!1;a.mousedown(function(t){1===t.which&&(n=!0,e())}),a.click(function(){return n?void(n=!1):void e()})}var a=$(n),i=t();i.setInitialValue(e.toggleValue),e.$watch("toggleValue",function(e){i.updateValue(e)}),r(function(){i.toggle(),e.toggleValue=!e.toggleValue,e.$apply()})}}}function t(){return{restrict:"A",link:function(e,n){$(n).on("dragstart",function(e){e.preventDefault()})}}}function r(){return{restrict:"A",scope:{spinnerValue:"="},link:function(e,n){$(n).spinner("changing",function(n,t){e.spinnerValue=t,e.$apply()})}}}function a(){return{restrict:"A",scope:{numberValue:"="},link:function(e,n){var t=$(n),r=100;t.on("keydown",function(e){var n=e.charCode||e.keyCode||0;return 8===n||9===n||46===n||n>=37&&40>=n||n>=48&&57>=n||n>=96&&105>=n}),t.on("keyup",function(){e.numberValue>r&&(e.numberValue=r,e.$apply())})}}}function i(){return{restrict:"E",scope:{options:"=",value:"=",optionsValue:"=",optionsText:"="},link:function(e,n){var t={dropdown:"dropdown",disabled:"disabled",expanded:"expanded",optionsList:"dropdown-options-list",optionItem:"dropdown-options-item",currentItem:"dropdown-current-item",currentItemText:"dropdown-current-item-text",indicatorHolder:"dropdown-indicator-holder",indicator:"dropdown-indicator"};n.addClass(t.dropdown);var r=$("<div />").addClass(t.currentItem).appendTo(n);$("<div />").addClass(t.currentItemText).appendTo(r);var a=$("<div />").addClass(t.indicatorHolder).appendTo(r);$("<span />").addClass(t.indicator).appendTo(a),$("<ul />").addClass(t.optionsList).appendTo(n),r.on("click",function(e){n.hasClass(t.disabled)||(r.toggleClass(t.expanded),e.stopPropagation())});var i=function(){r.removeClass(t.expanded)};$("html").bind("click",i),$(window).bind("blur",i),e.$watchGroup(["options","value"],function(r){var a=n.find("ul."+t.optionsList),i=n.find("div."+t.currentItemText),o=r[0],s=r[1],u=e.optionsText,d=e.optionsValue;a.empty(),$.each(o,function(n,r){return r[d]==s?void i.text(r[u]):void $("<li />").addClass(t.optionItem).appendTo(a).text(r[u]).on("click",function(){e.value=r[d],e.$apply()})})})}}}function o(){return function(e){return e?Object.keys(e):[]}}angular.module("configure").directive("tabs",e).directive("switchToggle",n).directive("disableDragAndDrop",t).directive("spinner",r).directive("number",a).directive("dropdown",i).filter("keys",o)}();