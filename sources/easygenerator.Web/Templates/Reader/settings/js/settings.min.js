!function(e){e.localize=function(e){return n[e]};var n={xx:"Custom",en:"English",nl:"Dutch",ua:"Ukrainian","changes are saved":"All changes are saved","changes are not saved":"Changes have NOT been saved. Please reload the page and change the settings again. Contact support@easygenerator.com if problem persists.","settings are not initialize":"Template settings are not initialized. Please reload the page and change the settings again. Contact support@easygenerator.com if problem persists.","graphical customization":"Graphical customization","template language":"Template language","customize your course":"Customize your course","look and feel of the course":"Change the look and feel of the course","custom course logo":"Custom course logo:",or:"or","upload logo image":"Upload logo image","logo hint":"Your logo will appear here<p>(recommended size 300 x 120 px)</p>","clear logo":"Clear logo","upgrade account hint":'You have to <a target="_blank" href="/account/upgrade">upgrade your account</a> in order to set custom course logo',"choose language for your course":"Choose language for your course",defaultText:"Default",translation:"Translation"}}(window.app=window.app||{}),function(){ko.bindingHandlers.fadeVisible={init:function(e,n){var t=n();$(e).toggle(ko.unwrap(t))},update:function(e,n){var t=n();ko.unwrap(t)?$(e).fadeIn():$(e).fadeOut()}},ko.bindingHandlers.dropdown={cssClasses:{dropdown:"dropdown",disabled:"disabled",expanded:"expanded",optionsList:"dropdown-options-list",optionItem:"dropdown-options-item",currentItem:"dropdown-current-item",currentItemText:"dropdown-current-item-text",indicatorHolder:"dropdown-indicator-holder",indicator:"dropdown-indicator"},init:function(e,n){var t=$(e),a=ko.bindingHandlers.dropdown.cssClasses;t.addClass(a.dropdown);var o=$("<div />").addClass(a.currentItem).appendTo(t);$("<div />").addClass(a.currentItemText).appendTo(o);var i=$("<div />").addClass(a.indicatorHolder).appendTo(o);$("<span />").addClass(a.indicator).appendTo(i),$("<ul />").addClass(a.optionsList).appendTo(t),o.on("click",function(e){t.hasClass(a.disabled)||(o.toggleClass(a.expanded),e.stopPropagation())});var s=function(){o.removeClass(a.expanded)};$("html").bind("click",s),$(window).bind("blur",s),ko.utils.domNodeDisposal.addDisposeCallback(e,function(){$("html").unbind("click",s),$(window).unbind("blur",s)})},update:function(e,n){var t=$(e),a=ko.bindingHandlers.dropdown.cssClasses,o=t.find("ul."+a.optionsList),i=t.find("div."+a.currentItemText),s=n().options,r=n().optionsText,l=n().value,u=n().optionsValue,d=ko.unwrap(l),c=ko.unwrap(n().disable);c?t.toggleClass(a.disabled):t.removeClass(a.disabled),o.empty(),$.each(s,function(e,n){return n[u]==d?void i.text(n[r]):void $("<li />").addClass(a.optionItem).appendTo(o).text(n[r]).on("click",function(e){l(n[u]),t.trigger("change")})})}},ko.bindingHandlers.tabs={init:function(e){var n=$(e),t="data-tab-link",a="data-tab",o="active",i=n.find("["+t+"]"),s=n.find("["+a+"]");s.hide(),i.first().addClass(o),s.first().show(),i.each(function(e,r){var l=$(r);l.on("click",function(){var e=l.attr(t),r=n.find("["+a+'="'+e+'"]');i.removeClass(o),l.addClass(o),s.hide(),r.show()})})}},ko.bindingHandlers.localize={init:function(e,n){var t=$(e),a=ko.unwrap(n());t.html(app.localize(a))}}}(),function(e){function n(e){function n(e){e&&r.setUrl(e.url)}function t(){r.isLoading(!1),r.isError(!1)}function a(e,n){r.clear(),r.isLoading(!1),r.errorText(e),r.errorDescription(n),r.isError(!0)}function o(){r.isLoading(!0)}function i(e){r.url(e||"")}function s(){return{url:r.url()}}var r=this;return r.url=ko.observable(""),r.hasLogo=ko.computed(function(){return""!==r.url()}),r.clear=function(){r.url("")},r.isError=ko.observable(!1),r.errorText=ko.observable(""),r.errorDescription=ko.observable(""),r.isLoading=ko.observable(!1),r.setDefaultStatus=t,r.setFailedStatus=a,r.setLoadingStatus=o,r.setUrl=i,r.getData=s,n(e),r}function t(n,t){function a(n,t){ko.utils.arrayForEach(n||[],function(n){s(new e.LanguageModel(n.code,e.localize(n.code),n.url))});var a=r(c),o=new e.LanguageModel(d,e.localize(d),a?a.resourcesUrl:null,t?t.customTranslations:null);s(o);var i=t&&t.selected?t.selected:c;u.selectedLanguageCode(i)}function o(){return u.selectedLanguageCode()===d}function i(){var e=r(d);return e?e.getNotMappedTranslations():[]}function s(e){u.languages.push(e)}function r(e){return ko.utils.arrayFirst(u.languages,function(n){return n.code===e})}function l(){var e={};u.selectedLanguageCode()&&(e.selected=u.selectedLanguageCode());var n=i();return n&&!$.isEmptyObject(n)&&(e.customTranslations=n),e}var u=this,d="xx",c="en";u.languages=[];var g=ko.observable(t&&t.selected?t.selected:null);return u.selectedLanguageCode=ko.pureComputed({read:function(){return g()},write:function(e){var n=r(e);if(n){if(n.isLoaded)return void g(e);u.isLanguageLoading(!0),n.load().done(function(){g(e),u.isLanguageLoading(!1)})}}}),u.selectedLanguageTranslations=ko.pureComputed(function(){var e=r(u.selectedLanguageCode());return e?e.getTranslations():null}),u.isLanguageLoading=ko.observable(!1),u.isLanguageEditable=o,u.getCustomTranslations=i,u.getData=l,a(n,t),u}function a(e,n,t,a){function o(e){g=u(e)}function i(){return g}function s(){return d(g)}function r(){return l(c.resourcesUrl).then(function(e){if(p){var n={};$.each(e,function(e,t){n[e]="string"==typeof p[e]?p[e]:t}),c.setTranslations(n)}else c.setTranslations(e);c.isLoaded=!0})}function l(e){return $.ajax({url:e,dataType:"json",contentType:"application/json"})}function u(e){var n=[];return e&&Object.keys(e).forEach(function(t){n.push({key:t,value:e[t]})}),n}function d(e){var n={};return e&&e.forEach(function(e){n[e.key]=e.value}),n}var c=this,g=[],p=a;c.code=e,c.name=n,c.isLoaded=!1,c.load=r,c.resourcesUrl=t,c.setTranslations=o,c.getTranslations=i,c.getNotMappedTranslations=s,a&&c.setTranslations(a)}e.LogoModel=n,e.LanguagesModel=t,e.LanguageModel=a}(window.app=window.app||{}),function(e){function n(){var e={apiUrl:o+"/storage/image/upload",maxFileSize:10,supportedExtensions:["jpeg","jpg","png","bmp","gif"],somethingWentWrongMessage:{title:"Something went wrong",description:"Please, try again"},status:{"default":function(){i.logo.setDefaultStatus()},fail:function(e){i.logo.setFailedStatus(e.title,e.description)},loading:function(){i.logo.isLoading(!0)}},button:{enable:function(){this.$input.attr("disabled",!1).closest(".image-upload-button").removeClass("disabled")},disable:function(){this.$input.attr("disabled",!0).closest(".image-upload-button").addClass("disabled")},submit:function(){this.$input[0].form.submit(),this.disable(),e.status.loading()},$input:$("#logoInput")},init:function(){e.button.$input.on("change",e.processFile),e.button.enable()},processFile:function(){if(!this.files)return void e.button.submit();if(0!==this.files.length){var n=this.files[0],t=n.name.split(".").pop().toLowerCase();return-1===$.inArray(t,e.supportedExtensions)?void e.status.fail({title:"Unsupported image format",description:"(Allowed formats: "+e.supportedExtensions.join(", ")+")"}):n.size>1024*e.maxFileSize*1024?void e.status.fail({title:"File is too large",description:"(Max file size: "+e.maxFileSize+"MB)"}):void e.uploadFile(n)}},uploadFile:function(n){e.button.disable(),e.status.loading();var t=new FormData;t.append("file",n),$.ajax({url:e.apiUrl,type:"POST",data:t,cache:!1,dataType:"json",processData:!1,contentType:!1}).done(function(n){e.handleResponse(n)}).fail(function(){e.status.fail(e.somethingWentWrongMessage),e.button.enable()})},handleResponse:function(n){try{if(!n)throw"Response is empty";if("object"!=typeof n&&(n=JSON.parse(n)),!n||!n.success||!n.data)throw"Request is not success";i.logo.setUrl(n.data.url),e.status["default"]()}catch(t){e.status.fail(e.somethingWentWrongMessage)}finally{e.button.enable()}}};return e}var t=null,a=null,o=location.protocol+"//"+location.host,i={languages:null,logo:null,userHasStarterPlan:ko.observable(!1)};i.getSettingsData=function(){return{logo:i.logo.getData(),languages:i.languages.getData()}},i.getExtraData=function(){return{}},i.saveChanges=function(){var n=i.getSettingsData(),o=i.getExtraData(),s=JSON.stringify(n),r=JSON.stringify(o);(JSON.stringify(t)!==s||JSON.stringify(a)!==r)&&window.egApi.saveSettings(s,r,e.localize("changes are saved"),e.localize("changes are not saved")).done(function(){t=n,a=o})},i.init=function(){var n=window.egApi;return n.init().then(function(){var o=n.getManifest(),s=n.getUser(),r=n.getSettings();s.accessType>0&&i.userHasStarterPlan(!0),i.languages=new e.LanguagesModel(o.languages,r.languages),i.logo=new e.LogoModel(r.logo),t=i.getSettingsData(),a=i.getExtraData()}).fail(function(){n.sendNotificationToEditor(e.localize("settings are not initialize"),!1)})},i.init().done(function(){$(document).ready(function(){if(ko.applyBindings(i,$(".settings-container")[0]),window.egApi.getUser().accessType>0){var e=new n;e.init()}$(window).on("blur",i.saveChanges)})})}(window.app=window.app||{});