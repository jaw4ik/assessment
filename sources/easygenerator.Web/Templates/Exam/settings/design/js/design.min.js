!function(e){e.localize=function(e){return o[e]};var o={"changes are saved":"All changes are saved","changes are not saved":"Changes have NOT been saved. Please reload the page and change the settings again. Contact support@easygenerator.com if problem persists.","settings are not initialize":"Template settings are not initialized. Please reload the page and change the settings again. Contact support@easygenerator.com if problem persists.","graphical customization":"Graphical customization","customize your course":"Customize your course","look and feel of the course":"Change the look and feel of the course","custom course logo":"Custom course logo:",or:"or","upload logo image":"Upload logo image","logo hint":"Your logo will appear here<p>(recommended size 300 x 50 px)</p>","clear logo":"Clear logo","choose color scheme":"Choose color scheme:","upgrade account hint":'You have to <a target="_blank" href="/account/upgrade">upgrade your account</a> in order to set custom course logo'}}(window.app=window.app||{}),function(e){function o(e){var o=e.name.split(".").pop().toLowerCase();return-1===$.inArray(o,a.supportedExtensions)?{title:"Unsupported image format",description:"(Allowed formats: "+a.supportedExtensions.join(", ")+")"}:e.size>1024*a.maxFileSize*1024?{title:"File is too large",description:"(Max file size: "+a.maxFileSize+"MB)"}:!0}var t=location.protocol+"//"+location.host+"/storage/image/upload",n={title:"Something went wrong",description:"Please, try again"},a={maxFileSize:10,supportedExtensions:["jpeg","jpg","png","bmp","gif"]};e.upload=function(e){var i=$.Deferred(),r=$("<form>").hide().attr("method","post").attr("enctype","multipart/form-data").insertAfter("body"),s=$("<input>").attr("accept",a.supportedExtensions.map(function(e){return"."+e}).join(", ")).attr("type","file").attr("name","file").on("change",function(){e&&e();var a=this.files[0],r=o(a);if(r!==!0)return void i.reject(r);var s=new FormData;s.append("file",a),$.ajax({url:t,type:"POST",data:s,contentType:!1,processData:!1}).done(function(e){try{var o=JSON.parse(e);o&&o.success&&o.data&&o.data.url?i.resolve(o.data.url):i.reject(n)}catch(t){i.reject(n)}}).fail(function(){i.reject(n)})}).appendTo(r);return s.click(),i.promise()}}(window.app=window.app||{}),function(){ko.bindingHandlers.fadeVisible={init:function(e,o){var t=o();$(e).toggle(ko.unwrap(t))},update:function(e,o){var t=o();ko.unwrap(t)?$(e).fadeIn():$(e).fadeOut()}},ko.bindingHandlers.localize={init:function(e,o){var t=$(e),n=ko.unwrap(o());t.html(app.localize(n))}}}(),function(e){function o(e){this.hasStarterPlan=e&&e.accessType>0}function t(o){function t(e){e&&l.setUrl(e.url)}function n(){l.isLoading()||e.upload(function(){r()}).done(function(e){s(e),a()}).fail(function(e){i(e.title,e.description)})}function a(){l.isLoading(!1),l.isError(!1)}function i(e,o){l.clear(),l.isLoading(!1),l.errorText(e),l.errorDescription(o),l.isError(!0)}function r(){l.isLoading(!0)}function s(e){l.url(e||"")}function c(){return{url:l.url()}}var l=this;return l.url=ko.observable(""),l.hasLogo=ko.computed(function(){return""!==l.url()}),l.clear=function(){l.url("")},l.isError=ko.observable(!1),l.errorText=ko.observable(""),l.errorDescription=ko.observable(""),l.isLoading=ko.observable(!1),l.setUrl=s,l.getData=c,l.upload=n,t(o),l}e.UserAccessModel=o,e.LogoModel=t}(window.app=window.app||{}),function(e){var o=null,t=null,n={userAccess:null,logo:null};n.getCurrentSettingsData=function(e){return $.extend({},e||o,{logo:n.logo.getData()})},n.getCurrentExtraData=function(){return{}},n.saveChanges=function(){var a=n.getCurrentSettingsData(),i=n.getCurrentExtraData(),r=JSON.stringify(a),s=JSON.stringify(i);(JSON.stringify(o)!==r||JSON.stringify(t)!==s)&&window.egApi.saveSettings(r,s,e.localize("changes are saved"),e.localize("changes are not saved")).done(function(){o=a,t=i})},n.init=function(){var a=window.egApi;return a.init().then(function(){var i=a.getUser(),r=a.getSettings();n.userAccess=new e.UserAccessModel(i),n.logo=new e.LogoModel(r.logo),o=n.getCurrentSettingsData(r),t=n.getCurrentExtraData()}).fail(function(){a.sendNotificationToEditor(e.localize("settings are not initialize"),!1)})},n.init().done(function(){$(document).ready(function(){ko.applyBindings(n,$(".settings-container")[0]),$(window).on("blur",n.saveChanges)})})}(window.app=window.app||{});